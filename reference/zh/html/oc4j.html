<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;26.&nbsp;Seam on OC4J</title><link rel="stylesheet" href="../shared/css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="Seam - &#35821;&#22659;&#30456;&#20851;&#30340;&#32452;&#20214; [&#28385;&#27743;&#32418;20080327]"><link rel="up" href="index.html" title="Seam - &#35821;&#22659;&#30456;&#20851;&#30340;&#32452;&#20214; [&#28385;&#27743;&#32418;20080327]"><link rel="previous" href="configuration.html" title="Chapter&nbsp;25.&nbsp;Seam&#37197;&#32622;&#21644;Seam&#24212;&#29992;&#31243;&#24207;&#25171;&#21253;"><link rel="next" href="annotations.html" title="Chapter&nbsp;27.&nbsp;Seam&#27880;&#35299;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;26.&nbsp;Seam on OC4J</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="configuration.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="annotations.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="oc4j"></a>Chapter&nbsp;26.&nbsp;Seam on OC4J</h2></div></div><div></div></div><p>
	OC4J&#65288;&#29992;&#20110;Java&#30340;Oracle&#23481;&#22120;&#65289;11g&#65288;&#30446;&#21069;&#26159;&#19968;&#20010;&#8220;&#25216;&#26415;&#39044;&#35272;&#8221;&#29256;&#26412;&#65289;&#26159;Oracle&#30340;JEE 5&#24212;&#29992;&#26381;&#21153;&#22120;&#12290;
	&#25105;&#20204;&#23558;&#20174;Seam&#33258;&#24102;&#30340;&#37202;&#24215;&#39044;&#35746;&#65288;Hotel Booking&#65289;&#30340;&#31034;&#20363;&#24212;&#29992;&#31243;&#24207;&#24320;&#22987;&#65292;&#26469;&#20102;&#35299;&#23427;&#30340;&#26500;&#24314;&#21644;&#37096;&#32626;&#65292;&#25509;&#30528;&#20102;&#35299;&#22914;&#20309;&#37096;&#32626;seam-gen&#29983;&#25104;&#30340;&#24037;&#31243;&#12290;
	&#36825;&#20010;&#24037;&#31243;&#23558;&#38598;&#25104;Seam&#12289;RichFaces Ajax&#21644;&#32452;&#20214;&#12289;Seam Security &#65288;&#21253;&#21547;Drools&#65289;&#12289;Facelets&#21644;Hibernate&#25552;&#20379;&#30340;JPA&#12290;
    </p><p>
    &#26412;&#33410;&#35201;&#27714;&#20320;&#20351;&#29992;OC4J 11g&#25216;&#26415;&#39044;&#35272;&#29256;&#65288;&#19981;&#26159;OC4J 10g&#65289;&#12290;&#20320;&#21487;&#20197;&#20174; <a href="http://www.oracle.com/technology/tech/java/oc4j/11/" target="_top">http://www.oracle.com/technology/tech/java/oc4j/11/</a> &#19979;&#36733;OC4J 11g&#12290;
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e14604"></a>26.1.&nbsp;<tt class="literal">jee5/booking</tt> &#23454;&#20363;</h2></div></div><div></div></div><p>
      <tt class="literal">jee5/booking</tt> &#23454;&#20363;&#22522;&#20110;&#19968;&#20010;&#65288;&#36816;&#34892;&#22312;JBoss AS&#20013;&#30340;&#65289;&#37202;&#24215;&#39044;&#35746;&#30340;&#20363;&#23376;&#12290;
      &#23427;&#26159;&#34987;&#35774;&#35745;&#20026;Glassfish&#24320;&#31665;&#21363;&#29992;&#65292;&#20294;&#26159;&#21487;&#20197;&#24456;&#23481;&#26131;&#22320;&#26500;&#24314;&#23427;&#65292;&#24182;&#36816;&#34892;&#22312;OC4J&#19978;&#12290;
      </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14614"></a>26.1.1.&nbsp;&#39044;&#35746;&#37202;&#24215;&#23454;&#20363;&#30340;&#20381;&#36182;&#21253;</h3></div></div><div></div></div><p>
          &#39318;&#20808;&#65292;&#35753;&#25105;&#20204;&#26469;&#30475;&#19968;&#19979;&#39044;&#35746;&#23454;&#20363;&#30340;&#20381;&#36182;&#21253;&#12290;&#26377;&#20102;&#36825;&#26041;&#38754;&#30340;&#30693;&#35782;&#65292;&#25105;&#20204;&#23601;&#21487;&#20197;&#20102;&#35299;&#30001;&#20110;OC4J&#30340;&#24341;&#20837;&#65292;&#24102;&#26469;&#20102;&#21738;&#20123;&#39069;&#22806;&#30340;&#20381;&#36182;&#21253;&#12290;
        </p><div class="itemizedlist"><ul type="disc"><li><p>
            <tt class="literal">jboss-seam.jar</tt> &#8212; &#25105;&#20204;&#25226;&#36825;&#20010;&#22768;&#26126;&#20026;&#19968;&#20010;EJB3&#27169;&#22359;&#65288;&#20026;&#20160;&#20040;&#21602;&#65311;Seam&#38656;&#35201;&#33021;&#22815;&#21644;&#23481;&#22120;&#31649;&#29702;&#20107;&#21153;CMT&#20132;&#20114;&#65307;&#23427;&#23454;&#29616;&#20026;&#19968;&#20010;EJB3&#30340;&#26377;&#29366;&#24577;&#20250;&#35805;Bean&#12290;&#65289;
            </p></li><li><p>
              <tt class="literal">jboss-el.jar</tt>
            </p></li><li><p>
              <tt class="literal">jboss-seam-ui.jar</tt> &#8212; Seam&#30340;JSF Control&#65292;&#20381;&#36182;Apache&#30340;commons-beanutils
            </p></li><li><p>
              <tt class="literal">jboss-seam-debug.jar</tt>
            </p></li><li><p>
              <tt class="literal">jsf-facelets.jar</tt>
            </p></li><li><p>
            &#12288;<tt class="literal">richfaces-api.jar</tt> &#8212; &#23427;&#38656;&#35201;Apache commons-digester&#21644;commons-beanutils
            </p></li><li><p>
              <tt class="literal">richfaces-impl.jar</tt> &#21644; <tt class="literal">richfaces-ui.jar</tt> &#8212; &#38656;&#35201;Apache commons-digester&#21644;commons-beanutils
            </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14665"></a>26.1.2.&nbsp;OC4J&#38656;&#35201;&#30340;&#39069;&#22806;&#20381;&#36182;&#21253;</h3></div></div><div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Hibernate &#8212; &#24403;&#28982;&#65292;&#25105;&#20204;&#20915;&#23450;&#20351;&#29992;Hibernate&#20316;&#20026;JPA&#25552;&#20379;&#32773;&#65288;&#32780;&#19981;&#26159;OC4J&#20013;&#24102;&#26377;&#30340;TopLink Essentials&#65289;
            </p><p>
            &#20026;&#20102;&#20351;&#29992;Hibernate&#20316;&#20026;JPA&#25552;&#20379;&#32773;&#65292;&#20320;&#38656;&#35201;&#19977;&#20010;jar&#21253;&#65288;<tt class="literal">hibernate3.jar</tt>&#12289;<tt class="literal">hibernate-annotations.jar</tt>&#12289;<tt class="literal">hibernate-entitymanager.jar</tt>&#65289;&#21644;&#20182;&#20204;&#30340;&#20381;&#36182;&#21253;&#65288;<tt class="literal">jboss-common.jar</tt>&#12289;<tt class="literal">jboss-archive-browsing.jar</tt>&#21644;<tt class="literal">ejb3-persistence.jar</tt>&#65289;&#12290;
            &#20320;&#21487;&#20197;&#22312;Seam&#21457;&#34892;&#21253;&#30340; <tt class="literal">hibernate/lib</tt> &#30446;&#24405;&#20013;&#25214;&#21040;&#36825;&#20123;jar&#21253;&#12290;
            </p></li><li><p>
            <tt class="literal">thirdparty-all.jar</tt> &#8212; &#26159;Seam&#25152;&#20381;&#36182;&#30340;&#31532;&#19977;&#26041;&#24211;&#30340;&#38598;&#21512;&#65288;&#22914;javassist&#65289;
            </p></li></ul></div><p>
        &#22312;&#22823;&#22810;&#25968;&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#20013;&#36816;&#34892;Seam&#65288;&#20363;&#22914;JBoss AS&#25110;&#26159;Glassfish&#65289;&#65292;&#20320;&#21482;&#38656;&#35201;&#21253;&#21547;&#19968;&#20123;&#20320;&#30495;&#27491;&#38656;&#35201;&#30340;&#20381;&#36182;&#21253;
        &#65288;&#20363;&#22914;&#65306;&#22914;&#26524;&#20320;&#20351;&#29992;Seam Text&#65292;&#20320;&#23601;&#38656;&#35201;&#21253;&#21547;ANTLR&#65289;&#65307;&#20294;&#26159;&#65292;&#22312;OC4J&#20013;&#65292;&#30001;&#20110;&#23427;&#8220;&#22855;&#24322;&#30340;&#8221;classloading&#65292;&#20320;&#24517;&#39035;&#22987;&#32456;&#21253;&#21547;&#23427;&#20204;&#65306;
        </p><div class="itemizedlist"><ul type="disc"><li><p>
            <tt class="literal">antlr-2.7.6.jar</tt> &#8212; Seam Text&#38656;&#35201;&#30340;&#12290;&#65288;&#22312;&#26412;&#20363;&#20013;&#27809;&#26377;&#29992;&#21040;&#65289;&#12290;
            </p></li><li><p>
            <tt class="literal">jbpm-jpdl.jar</tt> &#8212; Seam&#30340;JBPM&#38598;&#25104;&#25152;&#38656;&#35201;&#30340;&#65288;&#22312;&#26412;&#20363;&#20013;&#27809;&#26377;&#29992;&#21040;&#65289;&#12290;
            </p></li><li><p>
              Drools &#8212; Seam Security&#25152;&#38656;&#35201;&#30340;&#12290;&#23613;&#31649;&#25105;&#20204;&#27809;&#26377;&#36890;&#36807;Drools&#20351;&#29992;Seam Security&#65292;&#20294;&#36824;&#26159;&#24517;&#39035;&#21253;&#21547;&#23427;&#12290;
              Drools&#30001;5&#20010;jar&#21253;&#32452;&#25104; - <tt class="literal">drools-core-4.0.0.jar</tt>&#12289;
              <tt class="literal">drools-compiler-4.0.0.jar</tt>&#12289;
              <tt class="literal">janino-2.5.7.jar</tt>&#12289;
              <tt class="literal">mvel14-1.2rc1.jar</tt> &#21644;
              <tt class="literal">antlr-runtime-3.0.jar</tt>&#12290;&#22312;&#26412;&#20363;&#20013;&#27809;&#26377;&#29992;&#21040;Drools&#38598;&#25104;&#12290;
            </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14734"></a>26.1.3.&nbsp;&#37197;&#32622;&#25991;&#20214;&#30340;&#25913;&#21464;</h3></div></div><div></div></div><p>&#21482;&#26377;&#19968;&#20123;&#22320;&#26041;&#38656;&#35201;&#26356;&#25913;&#65306;</p><div class="variablelist"><dl><dt><span class="term">
              <tt class="literal">web.xml</tt>
            </span></dt><dd><p>
              &#20320;&#38656;&#35201;&#22312; <tt class="literal">web.xml</tt> &#20013;&#22768;&#26126;&#25152;&#26377;&#30340;EJB&#12290;&#36825;&#26159;&#35768;&#22810;JEE 5&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#30340;&#19968;&#20010;&#26080;&#32842;&#35201;&#27714; &#65293; &#20363;&#22914;OC4J&#21644;Glassfish&#12290;
              </p><pre class="programlisting">&lt;ejb-local-ref&gt;
   &lt;ejb-ref-name&gt;
      jboss-seam-jee5/AuthenticatorAction/local
   &lt;/ejb-ref-name&gt;
   &lt;ejb-ref-type&gt;Session&lt;/ejb-ref-type&gt;
   &lt;local-home/&gt;
   &lt;local&gt;
      org.jboss.seam.example.booking.Authenticator
   &lt;/local&gt;
   &lt;ejb-link&gt;AuthenticatorAction&lt;/ejb-link&gt;
&lt;/ejb-local-ref&gt;</pre></dd><dt><span class="term">
              <tt class="literal">persistence.xml</tt>
            </span></dt><dd><p>
              &#20320;&#38656;&#35201;&#25552;&#20379;&#19968;&#20010;&#27491;&#30830;&#30340;&#37197;&#32622;&#32473;&#20320;&#30340;JPA&#23454;&#29616;&#12290;&#25105;&#20204;&#26159;&#20351;&#29992;Hibernate&#65292;&#30001;&#20110;OC4J&#36824;&#26159;&#32465;&#23450;&#32769;&#30340;ANTLR&#65292;&#25105;&#20204;&#38656;&#35201;&#20351;&#29992;&#21487;&#36873;&#30340;&#26597;&#35810;&#24037;&#21378;&#65292;&#25105;&#20204;&#20063;&#24819;&#20351;&#29992;OC4J&#30340;&#20107;&#21153;&#31649;&#29702;&#22120;&#65306;
              </p><pre class="programlisting">&lt;property
   name="hibernate.query.factory_class"
   value="org.hibernate.hql.classic.ClassicQueryTranslatorFactory" /&gt;
&lt;property
   name="hibernate.transaction.manager_lookup_class"
   value="org.hibernate.transaction.OrionTransactionManagerLookup" /&gt;</pre></dd></dl></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14765"></a>26.1.4.&nbsp;&#26500;&#24314; <tt class="literal">jee5/booking</tt> &#23454;&#20363;</h3></div></div><div></div></div><div class="orderedlist"><ol type="1"><li><p>&#22312;&#24037;&#31243;&#20013;&#20462;&#25913;&#20197;&#19979;&#25991;&#20214;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>
                  <tt class="literal">build.xml</tt> &#8212; &#21453;&#27880;&#37322;OC4J&#30456;&#20851;&#30340;&#20381;&#36182;&#21253;
               </p></li><li><p>
                  <tt class="literal">resources/META-INF/persistence.xml</tt> &#8212; &#27880;&#37322;&#25481;Glassfish&#23646;&#24615;&#65292;&#21453;&#27880;&#37322;OC4J&#30340;&#23646;&#24615;
                </p></li></ul></div></li><li><p>
              &#36890;&#36807;&#36816;&#34892; <tt class="literal">ant</tt> &#26469;&#26500;&#24314;demo&#24212;&#29992;&#31243;&#24207;&#12290;&#26368;&#32456;&#26500;&#24314;&#25104; <tt class="literal">dist/jboss-seam-jee5.ear</tt>
            </p></li><li><p>
               &#23558; <tt class="literal">hsqldb.jar</tt> &#22797;&#21046;&#21040;OC4J&#20013;&#65306;
               <tt class="literal">cp ../../seam-gen/lib/hsqldb.jar $ORACLE_HOME/j2ee/home/applib/</tt>
               &#65288;&#30001;&#20110;OC4J&#24182;&#27809;&#26377;&#23884;&#20837;&#24335;&#30340;&#25968;&#25454;&#24211;&#65292;&#22240;&#27492;&#25105;&#20204;&#20915;&#23450;&#20351;&#29992;HSQLDB&#65289;&#12290;
              </p></li></ol></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e14806"></a>26.2.&nbsp;&#37096;&#32626;Seam&#24212;&#29992;&#31243;&#24207;&#21040;OC4J&#20013;</h2></div></div><div></div></div><p>
      &#36825;&#20010;&#36855;&#20320;&#22411;&#30340;&#25945;&#31243;&#65288;&#26377;&#28857;&#20047;&#21619;&#65289;&#25551;&#36848;&#20102;&#23558;&#19968;&#20010;JEE 5&#24212;&#29992;&#31243;&#24207;&#37096;&#32626;&#21040;OC4J&#20013;&#25152;&#38656;&#30340;&#27493;&#39588;&#12290;
      &#20551;&#35774;&#20320;&#27491;&#22312;&#37096;&#32626;&#20351;&#29992;&#20102;&#23884;&#20837;&#24335;&#30340;hsqldb&#25968;&#25454;&#24211;&#30340; <tt class="literal">jee5/booking</tt> &#23454;&#20363;&#12290;
      &#20026;&#20102;&#37096;&#32626;&#20854;&#20182;&#30340;&#24212;&#29992;&#31243;&#24207;&#65292;&#20320;&#38656;&#35201;&#26356;&#25913;&#25968;&#25454;&#28304;&#21517;&#31216;&#21644;&#24212;&#29992;&#31243;&#24207;&#21517;&#31216;&#12290;
      </p><div class="orderedlist"><ol type="1"><li><p>
            &#19979;&#36733;&#21644;&#35299;&#21387;OC4J
          </p></li><li><p>
          &#35831;&#30830;&#35748;&#20320;&#24050;&#32463;&#35774;&#32622;&#20102; <tt class="literal">$JAVA_HOME</tt> &#21644; <tt class="literal">$ORACLE_HOME</tt> &#20316;&#20026;&#29615;&#22659;&#21464;&#37327;
          &#65288;<tt class="literal">$ORACLE_HOME</tt>&#36825;&#20010;&#26159;&#25351;&#35299;&#21387;&#21518;OC4J&#30340;&#30446;&#24405;&#21517;&#31216;&#65289;&#12290;
          &#24819;&#20102;&#35299;&#26356;&#22810;&#26377;&#20851;&#23433;&#35013;OC4J&#30340;&#20449;&#24687;&#65292;&#35831;&#21442;&#32771;OC4J&#21457;&#24067;&#21253;&#20013;&#30340; <tt class="literal">Readme.txt</tt> &#12290;
          </p></li><li><p>
          &#32534;&#36753;OC4J&#25968;&#25454;&#28304; <tt class="literal">$ORACLE_HOME/j2ee/home/config/data-sources.xml</tt>&#65292;&#24182;&#22312; <tt class="literal">&lt;data-sources&gt;</tt> &#20013;&#22686;&#21152;
          </p><pre class="programlisting">&lt;managed-data-source
   connection-pool-name="jee5-connection-pool"
   jndi-name="jdbc/__default"
   name="jee5-managed-data-source" /&gt;
&lt;connection-pool name="jee5-connection-pool"&gt;
   &lt;connection-factory
      factory-class="org.hsqldb.jdbcDriver"
      user="sa"
      password=""
      url="jdbc:hsqldb:." /&gt;
&lt;/connection-pool&gt;</pre><p>
          &#22312; <tt class="literal">persistence.xml</tt> &#37324;&#65292;<tt class="literal">jndi-name</tt> &#34987;&#29992;&#20316; <tt class="literal">jta-data-source</tt>&#12290;
          </p></li><li><p>
          &#32534;&#36753; <tt class="literal">$ORACLE_HOME/j2ee/home/config/server.xml</tt> &#65292;&#22312; <tt class="literal">&lt;application-server&gt;</tt>&#20013;&#22686;&#21152;
          </p><pre class="programlisting">&lt;application name="jboss-seam-jee5"
 path="../../home/applications/jboss-seam-jee5.ear"
 parent="default"
 start="true" /&gt;</pre><p>
          &#20026;&#20102;&#35753;&#20107;&#24773;&#31616;&#21333;&#20123;&#65292;&#23601;&#37319;&#29992;&#20320;&#32473;&#39033;&#30446;&#25152;&#29992;&#30340;&#30456;&#21516;&#21517;&#23383;&#12290;
          </p></li><li><p>
          &#32534;&#36753; <tt class="literal">$ORACLE_HOME/j2ee/home/config/default-web-site.xml</tt>&#65292;&#22312; <tt class="literal">&lt;web-site&gt;</tt> &#20013;&#22686;&#21152;
          </p><pre class="programlisting">&lt;web-app application="jboss-seam-jee5"
 name="jboss-seam-jee5"
 load-on-startup="true"
 root="/seam-jee5" /&gt;</pre><p>
          <tt class="literal">root</tt> &#23601;&#26159;&#20320;&#23558;&#36755;&#20837;&#21040;Web&#27983;&#35272;&#22120;&#29992;&#26469;&#35775;&#38382;&#24212;&#29992;&#31243;&#24207;&#30340;&#19978;&#19979;&#25991;&#36335;&#24452;&#12290;
          </p></li><li><p>
          &#23558;&#24212;&#29992;&#31243;&#24207;&#22797;&#21046;&#21040;OC4J&#65306;<tt class="literal">cp dist/jboss-seam-jee5.ear $ORACLE_HOME/j2ee/home/applications/</tt>
           </p></li><li><p>
          &#21551;&#21160;OC4J&#65306;<tt class="literal">$ORACLE_HOME/bin/oc4j -start</tt>
          </p><p>
          &#22914;&#26524;&#26159;&#31532;&#19968;&#27425;&#21551;&#21160;OC4J&#65292;&#24744;&#23558;&#34987;&#35201;&#27714;&#35774;&#32622;&#31649;&#29702;&#21592;&#23494;&#30721;
          </p></li><li><p>
          &#22312; <tt class="literal">http://localhost:8888/seam-jee5</tt> &#20013;&#26816;&#39564;&#24212;&#29992;&#31243;&#24207;
          </p></li><li><p>
          &#20320;&#21487;&#20197;&#36890;&#36807;&#22312;&#26381;&#21153;&#22120;&#36816;&#34892;&#30340;&#25511;&#21046;&#21488;&#19978;&#25353;&#19979; <tt class="literal">CTRL-C</tt> &#26469;&#20572;&#27490;&#26381;&#21153;&#22120;&#12290;
          </p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e14910"></a>26.3.&nbsp;
      &#23558;&#19968;&#20010;&#20351;&#29992; <tt class="literal">seam-gen</tt> &#21019;&#24314;&#30340;&#24212;&#29992;&#31243;&#24207;&#37096;&#32626;&#21040;OC4J&#20013;&#12290;
      </h2></div></div><div></div></div><p>
      &#25509;&#19979;&#26469;&#30340;&#35828;&#26126;&#20551;&#35774;&#20320;&#27491;&#22312;&#20351;&#29992;&#21629;&#20196;&#34892;&#30340;&#26041;&#24335;&#21644;&#19968;&#20010;&#31616;&#21333;&#30340;&#25991;&#26412;&#32534;&#36753;&#22120;&#65292;&#24403;&#28982;&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;&#33258;&#24049;&#29087;&#24713;&#30340;IDE &#65293; <tt class="literal">seam-gen</tt> &#39033;&#30446;&#65292;&#21516;&#26102;&#25903;&#25345;Eclipse&#21644;Netbeans&#12290;
      </p><p>
      &#25105;&#20204;&#20174;&#20351;&#29992; <tt class="literal">seam-gen</tt> &#26469;&#21019;&#24314;&#19968;&#20010;&#38750;&#24120;&#31616;&#21333;&#30340;&#24212;&#29992;&#31243;&#24207;&#24320;&#22987;&#12290;
      <tt class="literal">seam-gen</tt> &#20351;&#29992;Hibernate Tools &#26469;&#23558;&#25968;&#25454;&#24211;&#30340;Scheam&#21453;&#21521;&#24037;&#31243;&#20026;JPA&#30340;&#23454;&#20307;Bean&#65307;
      &#23427;&#20063;&#21487;&#20197;&#29983;&#25104;Seam&#24212;&#29992;&#31243;&#24207;&#30340;&#26694;&#26550;&#32452;&#20214;&#21644;JSF&#30340;CRUD&#65288;&#21019;&#24314;&#12289;&#35835;&#21462;&#12289;&#26356;&#26032;&#21644;&#21024;&#38500;&#65289;&#35270;&#22270;&#12290;
      &#36825;&#20010;&#25945;&#31243;&#20351;&#29992;MySQL&#25968;&#25454;&#24211;&#65288;&#24403;&#28982;&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;&#20219;&#20309;&#20854;&#20182;&#30340;&#25968;&#25454;&#24211;&#65292;&#26356;&#25913;&#30456;&#24212;&#30340;SQL&#23601;&#21487;&#20197;&#20102;&#65289;&#65307;&#23433;&#35013;&#12289;&#37197;&#32622;&#21644;&#36816;&#34892;MySQL&#65292;&#28982;&#21518;&#21019;&#24314;&#25968;&#25454;&#24211;&#65292;&#24182;&#24102;&#26377;&#19968;&#20123;&#33539;&#20363;&#25968;&#25454;&#12290;
      </p><p>
      &#25509;&#19979;&#26469;&#65292;&#22312;Seam&#30340;&#30446;&#24405;&#20013;&#36816;&#34892; <tt class="literal">./seam setup</tt>&#12290;
      </p><pre class="programlisting">&gt; ./seam setup
Buildfile: build.xml

setup:
    [echo] Welcome to seam-gen :-)
    [input] Enter your Java project workspace (the directory that contains your Seam projects) [/home/pmuir/workspace] [/home/pmuir/workspace]

    [input] Enter your JBoss home directory [/home/pmuir/java/jboss-4.2.1.GA] [/home/pmuir/java/jboss-4.2.1.GA]

    [input] Enter the project name [oc4j-example] [oc4j-example]

    [input] Is this project deployed as an EAR (with EJB components) or a WAR (with no EJB support) [ear]  ([ear], war, )

    [input] Enter the Java package name for your session beans [org.jboss.seam.tutorial.oc4j.action] [org.jboss.seam.tutorial.oc4j.action]

    [input] Enter the Java package name for your entity beans [org.jboss.seam.tutorial.oc4j.model] [org.jboss.seam.tutorial.oc4j.model]

    [input] Enter the Java package name for your test cases [org.jboss.seam.tutorial.oc4j.test] [org.jboss.seam.tutorial.oc4j.test]

    [input] What kind of database are you using? [mysql]  (hsql, [mysql], oracle, postgres, mssql, db2, sybase, enterprisedb, )

    [input] Enter the Hibernate dialect for your database [org.hibernate.dialect.MySQLDialect] [org.hibernate.dialect.MySQLDialect]

    [input] Enter the filesystem path to the JDBC driver jar [lib/mysql.jar] [lib/mysql.jar]

    [input] Enter JDBC driver class for your database [com.mysql.jdbc.Driver] [com.mysql.jdbc.Driver]

    [input] Enter the JDBC URL for your database [jdbc:mysql:///oc4j] [jdbc:mysql:///oc4j]

    [input] Enter database username [user] [user]

    [input] Enter database password [password] [password]

    [input] skipping input as property hibernate.default_schema.new has already been set.
    [input] Enter the database catalog name (it is OK to leave this blank) [] []

    [input] Are you working with tables that already exist in the database? [y]  ([y], n, )

    [input] Do you want to drop and recreate the database tables and data in import.sql each time you deploy? [n]  (y, [n], )

    [propertyfile] Updating property file: /home/pmuir/workspace/jboss-seam/seam-gen/build.properties
    [echo] Installing JDBC driver jar to JBoss server
    [echo] Type 'seam new-project' to create the new project

BUILD SUCCESSFUL</pre><p>
      &#36755;&#20837; <tt class="literal">./seam new-project</tt> &#26469;&#21019;&#24314;&#20320;&#30340;&#24037;&#31243;&#65292;&#24182; <tt class="literal">cd</tt> &#36827;&#20837;&#21040;&#21018;&#21019;&#24314;&#30340;&#24037;&#31243;&#37324;&#12290;
      </p><p>
      &#36755;&#20837; <tt class="literal">./seam generate-entities</tt> &#26469;&#36816;&#34892;&#21019;&#24314;&#30340;&#23454;&#20307;&#65292;Seam&#24212;&#29992;&#31243;&#24207;&#26694;&#26550;&#31867;&#21644;&#30456;&#20851;&#30340;&#35270;&#22270;&#12290;
      </p><p>
      &#25105;&#20204;&#29616;&#22312;&#38656;&#35201;&#23545;&#29983;&#25104;&#30340;&#24037;&#31243;&#36827;&#34892;&#19968;&#20123;&#20462;&#25913;&#12290;&#35753;&#25105;&#20204;&#20174;&#37197;&#32622;&#25991;&#20214;&#24320;&#22987;&#65306;
      </p><div class="variablelist"><dl><dt><span class="term">
            <tt class="literal">resources/META-INF/persistence-dev.xml</tt>
          </span></dt><dd><div class="itemizedlist"><ul type="disc"><li><p>
                &#26356;&#25913; <tt class="literal">jta-data-source</tt> &#20026; <tt class="literal">jdbc/__oc4jExample</tt>
                &#65288;&#24403;&#22312; <tt class="literal">data-sources.xml</tt> &#21019;&#24314;&#25968;&#25454;&#28304;&#26102;&#65292;&#29992;&#36825;&#20010;&#20316;&#20026; <tt class="literal">jndi-name</tt> &#65289;
                </p></li><li><p>
                &#28155;&#21152;&#19978;&#36848;&#30340;&#23646;&#24615;&#65306;
                </p><pre class="programlisting">&lt;property name="hibernate.query.factory_class"
   value="org.hibernate.hql.classic.ClassicQueryTranslatorFactory" /&gt;
&lt;property name="hibernate.transaction.manager_lookup_class"
   value="org.hibernate.transaction.OrionTransactionManagerLookup" /&gt;
&lt;property name="hibernate.transaction.flush_before_completion"
   value="true"/&gt;
&lt;property name="hibernate.cache.provider_class"
   value="org.hibernate.cache.HashtableCacheProvider"/&gt;</pre></li><li><p>
                &#21024;&#38500;JBoss AS&#20013;&#26292;&#38706;EntityManagerFactory&#30340;&#26041;&#27861;:
                </p><pre class="programlisting">&lt;property
 name="jboss.entity.manager.factory.jndi.name"
 value="java:/oc4j-exampleEntityManagerFactory"&gt;</pre></li><li><p>
                &#21516;&#26679;&#22320;&#65292;&#22914;&#26524;&#20320;&#24819;&#20351;&#29992;&#20808;&#21069;&#30340;&#25991;&#20214;&#37096;&#32626;&#21040;OC4J&#20013;&#65292;&#23601;&#38656;&#35201;&#26356;&#25913; <tt class="literal">persistence-prod.xml</tt> &#12290;
                </p></li></ul></div></dd><dt><span class="term">
            <tt class="literal">resources/META-INF/jboss-app.xml</tt>
          </span></dt><dd><p>
            &#20320;&#21487;&#20197;&#21024;&#38500;&#36825;&#20010;&#25991;&#20214;&#65292;&#30001;&#20110;&#25105;&#20204;&#27809;&#26377;&#37096;&#32626;&#21040;JBoss AS&#20013;&#65288;<tt class="literal">jboss-app.xml</tt> &#29992;&#20110;&#22312;JBoss AS&#20013;&#28608;&#27963;classloading&#38548;&#31163;&#65289;&#12290;
            </p></dd><dt><span class="term">
            <tt class="literal">resources/*-ds.xml</tt>
          </span></dt><dd><p>
            &#20320;&#21487;&#20197;&#21024;&#38500;&#36825;&#20123;&#25991;&#20214;&#65292;&#30001;&#20110;&#25105;&#20204;&#20063;&#27809;&#26377;&#37096;&#32626;&#21040;JBoss AS&#20013;
            &#65288;&#22312;JBoss AS&#20013;&#36825;&#20123;&#25991;&#20214;&#23450;&#20041;&#20102;&#25968;&#25454;&#28304;&#65292;&#22312;OC4J&#20013;&#65292;&#20320;&#24517;&#39035;&#32534;&#36753;&#20027;&#35201;&#30340; <tt class="literal">data-sources.xml</tt> &#25991;&#20214;&#12290;&#65289;
            </p></dd><dt><span class="term">
            <tt class="literal">resources/WEB-INF/components.xml</tt>
          </span></dt><dd><div class="itemizedlist"><ul type="disc"><li><p>
                &#28608;&#27963;CMT&#65288;container managed transaction&#65306;&#23481;&#22120;&#31649;&#29702;&#20107;&#21153;&#8212;&#65289;&#38598;&#25104; &#65293; &#28155;&#21152; <tt class="literal">&lt;transaction:ejb-transaction /&gt;</tt> &#32452;&#20214;&#65292;
                &#21644;&#23427;&#30340;&#21629;&#21517;&#31354;&#38388;&#22768;&#26126; <tt class="literal">xmlns:transaction="http://jboss.com/products/seam/transaction"</tt>
                </p></li><li><p>
                &#23558; <tt class="literal">jndi-pattern</tt> &#26356;&#25913;&#20026; <tt class="literal">java:comp/env/oc4j-example/#{ejbName}/local</tt>
                </p></li><li><p>
                &#25105;&#20204;&#24819;&#22312;&#25105;&#20204;&#30340;&#24212;&#29992;&#31243;&#24207;&#24403;&#20013;&#20351;&#29992;Seam&#30340;MPC&#65288;Managed Persistence Context&#65306;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#31649;&#29702;&#65289;&#12290;
                &#19981;&#24184;&#30340;&#26159;&#65292;OC4J&#27809;&#26377;&#20197;JNDI&#24418;&#24335;&#26292;&#38706;EntityManagerFactory&#65292;&#20294;&#26159;Seam&#25552;&#20379;&#20102;&#19968;&#20010;&#20869;&#32622;&#30340;&#31649;&#29702;&#22120;&#32452;&#20214;&#65306;
                </p><pre class="programlisting">&lt;persistence:entity-manager-factory
 auto-create="true"
 name="oc4jEntityManagerFactory"
 persistence-unit-name="oc4j-example" /&gt;</pre><p>
                &#25509;&#19979;&#26469;&#25105;&#20204;&#38656;&#35201;&#21578;&#30693;Seam&#26469;&#20351;&#29992;&#23427;&#65292;&#22240;&#27492;&#25105;&#20204;&#26356;&#25913;&#27880;&#20837;&#23454;&#20307;&#31649;&#29702;&#22120;&#24037;&#21378;&#30340; <tt class="literal">managed-persistence-context</tt>&#65306;
                </p><pre class="programlisting">&lt;persistence:managed-persistence-context
 name="entityManager"
 auto-create="true"
 entity-manager-factory="#{oc4jEntityManagerFactory}" /&gt;
                </pre></li></ul></div></dd><dt><span class="term">
            <tt class="literal">resources/WEB-INF/web.xml</tt>
          </span></dt><dd><p>
            &#22312;&#36825;&#37324;&#65292;&#20320;&#38656;&#35201;&#22768;&#26126;&#20320;&#25152;&#26377;&#30340;EJB&#12290;&#35760;&#20303;&#21253;&#25324;Seam&#30340;&#23481;&#22120;&#31649;&#29702;&#20107;&#21153;&#38598;&#25104;&#65306;
            </p><pre class="programlisting">&lt;ejb-local-ref&gt;
   &lt;ejb-ref-name&gt;
      oc4j-example/EjbSynchronizations/local
   &lt;/ejb-ref-name&gt;
   &lt;ejb-ref-type&gt;Session&lt;/ejb-ref-type&gt;
   &lt;local&gt;
      org.jboss.seam.transaction.LocalEjbSynchronizations
   &lt;/local&gt;
   &lt;ejb-link&gt;EjbSynchronizations&lt;/ejb-link&gt;
&lt;/ejb-local-ref&gt;</pre></dd><dt><span class="term">
            <tt class="literal">build.xml</tt>
          </span></dt><dd>
          &#25913;&#21464;&#40664;&#35748;&#30340;target&#26469;&#23436;&#25104;&#65288;&#25105;&#20204;&#19981;&#25171;&#31639;&#35206;&#30422;OC4J&#30340;&#33258;&#21160;&#37096;&#32626;&#65289;&#12290;
          </dd></dl></div><p>
      &#29616;&#22312;&#65292;&#35753;&#25105;&#20204;&#26469;&#28155;&#21152;&#19968;&#20123;&#39069;&#22806;&#30340;&#20381;&#36182;&#21253;&#65306;
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Hibernate &#8212;
          </p><div class="itemizedlist"><ul type="circle"><li><p>
              &#23558;Seam&#21457;&#34892;&#21253;&#20013; <tt class="literal">hibernate/lib</tt> &#30446;&#24405;&#19979;&#25152;&#26377;&#30340;jar&#25991;&#20214;&#25335;&#36125;&#21040; <tt class="literal">oc4j-example/lib</tt> &#30446;&#24405;&#19979;&#65306;
              <tt class="literal">cp ../jboss-seam/hibernate/lib/*.jar lib/</tt>
              </p></li><li><p>
              &#26356;&#25913; build.xml&#65292;&#23558;&#23427;&#20204;&#21253;&#21547;&#22312;ear&#21253;&#20013; &#65293; &#35201;&#28155;&#21152;&#30340;&#36825;&#20123;&#21253;&#25324;&#22312;&#20854;&#20182;&#22791;&#20221;&#24211;&#19979;&#26041;&#65306;
              </p><pre class="programlisting">&lt;include name="lib/hibernate-annotations.jar" /&gt;
&lt;include name="lib/hibernate-entitymanager.jar" /&gt;
&lt;include name="lib/hibernate3.jar" /&gt;
&lt;include name="ejb3-peristence.jar" /&gt;
&lt;include name="lib/jboss-archive-browsing.jar" /&gt;
&lt;include name="lib/jboss-common.jar" /&gt;</pre></li></ul></div></li><li><p>
          <tt class="literal">thirdparty-all.jar</tt> &#8212; &#26356;&#25913; <tt class="literal">build.xml</tt> &#21253;&#21547;&#23427; &#65293; &#28155;&#21152;&#36825;&#20010;&#65306;
          </p><pre class="programlisting">&lt;include name="lib/thirdparty-all.jar" /&gt;</pre></li><li><p>
          <tt class="literal">antlr-2.7.6.jar</tt> &#8212; &#26356;&#25913; <tt class="literal">build.xml</tt> &#21253;&#21547;&#23427; &#65293; &#28155;&#21152;&#36825;&#20010;:
          </p><pre class="programlisting">&lt;include name="lib/antlr-*.jar" /&gt;</pre></li><li><p>
          &#30001;&#20110;&#25105;&#20204;&#20351;&#29992;Drools&#26469;&#25552;&#20379;Seam Security&#35268;&#21017;&#65292;&#25105;&#20204;&#38656;&#35201;&#28155;&#21152;&#22312;Eclipse JDT&#32534;&#35793;&#22120;&#20013;&#65288;&#22312;JBoss AS&#20013;&#20320;&#19981;&#38656;&#35201;&#36825;&#20010;&#65307;&#20877;&#35828;&#19968;&#27425;&#65292;&#36825;&#26159;&#30001;&#20110;OC4J&#30340;classloading&#36896;&#25104;&#30340;&#65289;&#65306;
          </p><div class="itemizedlist"><ul type="circle"><li><pre class="programlisting">cp ../jboss-seam/seam-gen/lib/org.eclipse.jdt.core*.jar lib/</pre></li><li><p>
              &#26356;&#25913; build.xml &#23558;&#23427;&#20204;&#21253;&#21547;&#22312;ear&#21253;&#20013;&#65306;
              </p><pre class="programlisting">&lt;include name="lib/org.eclipse.jdt.core*.jar" /&gt;</pre></li></ul></div></li></ul></div><p>
      &#20320;&#24212;&#35813;&#31867;&#20284;&#20110;&#19979;&#38754;&#36825;&#26679;&#32467;&#26463;&#65306;
      </p><pre class="programlisting">&lt;fileset dir="${basedir}"&gt;
   &lt;!-- other libraries added by seam-gen --&gt;
   &lt;include name="lib/hibernate-annotations.jar" /&gt;
   &lt;include name="lib/hibernate-entitymanager.jar" /&gt;
   &lt;include name="lib/hibernate3.jar" /&gt;
   &lt;include name="lib/jboss-archive-browsing.jar" /&gt;
   &lt;include name="lib/jboss-common.jar" /&gt;
   &lt;include name="lib/thirdparty-all.jar" /&gt;
   &lt;include name="lib/antlr-*.jar" /&gt;
   &lt;include name="lib/org.eclipse.jdt.core*.jar" /&gt;
&lt;/fileset&gt;</pre><p>
      &#26368;&#21518;&#65292;&#35753;&#25105;&#20204;&#23558; <tt class="literal">User</tt> &#23454;&#20307;&#36830;&#25509;&#21040;Seam Security&#20013;
      &#65288;&#25105;&#20204;&#26377;&#19968;&#20010;&#21253;&#21547;<tt class="literal">username</tt> &#21015;&#21644; <tt class="literal">password</tt> &#21015;&#30340; <tt class="literal">User</tt> &#34920;&#65289;&#12290;
      &#25105;&#20204;&#23558;&#20351;&#39564;&#35777;&#22120;&#21464;&#25104;&#19968;&#20010;&#26080;&#29366;&#24577;&#20250;&#35805;Bean&#65288;&#27605;&#31455;OC4J&#20063;&#26159;EJB3&#30340;&#23481;&#22120;&#65281;&#65289;&#65306;
      </p><div class="orderedlist"><ol type="1"><li><div class="itemizedlist"><ul type="disc"><li><p>
              &#28155;&#21152; <tt class="literal">@Stateless</tt> &#27880;&#35299;&#12290;
              </p></li><li><p>
              &#23558;&#31867;&#37325;&#21629;&#21517;&#20026; <tt class="literal">AuthenticatorAction</tt>
              </p></li><li><p>
              &#21019;&#24314;&#19968;&#20010;&#20855;&#21517;&#20026; <tt class="literal">Authenticator</tt> &#30340;&#25509;&#21475;&#65292;&#24182;&#30001; <tt class="literal">AuthenticatorAction</tt> &#26469;&#23454;&#29616;&#36825;&#20010;&#25509;&#21475;&#65288;EJB3&#35201;&#27714;&#20250;&#35805;Bean&#35201;&#26377;&#19968;&#20010;&#26412;&#22320;&#25509;&#21475;&#65289;&#12290;
              &#20351;&#29992; <tt class="literal">@Local</tt> &#26469;&#27880;&#35299;&#36825;&#20010;&#25509;&#21475;&#65292;&#28982;&#21518;&#22686;&#21152;&#19968;&#20010;&#19982;<tt class="literal">AuthenticatorAction</tt> &#20013;&#30340; <tt class="literal">authenticate</tt> &#26041;&#27861;&#21516;&#26679;&#31614;&#21517;&#30340;&#26041;&#27861;&#12290;
              </p></li></ul></div><pre class="programlisting">@Name("authenticator") @Stateless public class
            AuthenticatorAction implements Authenticator {</pre><pre class="programlisting">@Local public interface Authenticator {
  public boolean authenticate();
}</pre></li><li><p>
          &#20351;&#29992; <tt class="literal">@PersistenceContext</tt> &#27880;&#35299;&#26469;&#27880;&#20837;EntityManager&#65306;
          </p><pre class="programlisting">@PersistenceContext private EntityManager entityManager;</pre></li><li><p>
          &#23454;&#29616;authenticate&#65306;
          </p><pre class="programlisting">public boolean authenticate() {
   List &amp;lt;User&amp;gt; users = entityManager .createQuery("select u from User u where
   u.username = #{identity.username} and
   u.password = #{identity.password}") .getResultList();
   if (users.size() == 1) {
      identity.addRole("admin");
      return true;
   } else {
      return false;
   }
}</pre></li><li><p>
          &#28982;&#21518;&#22312; <tt class="literal">web.xml</tt> &#20013;&#28155;&#21152;EJB3&#30340;&#24341;&#29992;&#65306;
          </p><pre class="programlisting">&lt;ejb-local-ref&gt;
   &lt;ejb-ref-name&gt;
      oc4j-example/AuthenticatorAction/local
   &lt;/ejb-ref-name&gt;
   &lt;ejb-ref-type&gt;Session&lt;/ejb-ref-type&gt;
   &lt;local&gt;
      org.jboss.seam.tutorial.oc4j.action.Authenticator
   &lt;/local&gt;
   &lt;ejb-link&gt;AuthenticatorAction&lt;/ejb-link&gt;
&lt;/ejb-local-ref&gt;</pre></li></ol></div><p>
    &#29616;&#22312;&#20320;&#21487;&#20197;&#32487;&#32493;&#24182;&#23450;&#21046;&#20320;&#33258;&#24049;&#30340;&#24212;&#29992;&#31243;&#24207;&#20102;&#12290;
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15208"></a>26.3.1.&nbsp;seam-gen&#20043;&#31867;&#30340;&#24212;&#29992;&#31243;&#24207;&#30340;OC4J&#37096;&#32626;&#25551;&#36848;&#31526;</h3></div></div><div></div></div><p>
        &#20026;&#20102;&#20351;&#29992;&#19978;&#36848;&#37096;&#32626;&#25351;&#20196;&#26469;&#37096;&#32626;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#65292;&#35201;&#32467;&#21512;&#20351;&#29992;&#36825;&#20123;&#37096;&#32626;&#25551;&#36848;&#31526;&#65306;
        </p><div class="variablelist"><dl><dt><span class="term">
              <tt class="literal">$ORACLE_HOME/j2ee/home/config/data-sources.xml</tt>
            </span></dt><dd><pre class="programlisting">&lt;managed-data-source
   connection-pool-name="oc4j-example-connection-pool"
   jndi-name="jdbc/__oc4jExample"
   name="oc4j-example-managed-data-source" /&gt;
&lt;connection-pool
   name="oc4j-example-connection-pool"&gt;
   &lt;connection-factory
      factory-class="com.mysql.jdbc.Driver"
      user="username"
      password="password"
      url="jdbc:mysql:///oc4j" /&gt;
&lt;/connection-pool&gt;</pre></dd><dt><span class="term">
              <tt class="literal">$ORACLE_HOME/j2ee/home/config/server.xml</tt>
            </span></dt><dd><pre class="programlisting">&lt;application name="oc4j-example"
 path="../../home/applications/oc4j-example.ear"
 parent="default"
 start="true" /&gt;</pre></dd><dt><span class="term">
              <tt class="literal">$ORACLE_HOME/j2ee/home/config/default-web-site.xml</tt>
            </span></dt><dd><pre class="programlisting">&lt;web-app application="oc4j-example"
 name="oc4j-example"
 load-on-startup="true"
 root="/oc4j-example" /&gt;</pre></dd></dl></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="configuration.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="annotations.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;25.&nbsp;Seam&#37197;&#32622;&#21644;Seam&#24212;&#29992;&#31243;&#24207;&#25171;&#21253;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;27.&nbsp;Seam&#27880;&#35299;</td></tr></table></div></body></html>