<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;22.&nbsp;Seam&#21644;Google&#30340;Web&#24037;&#20855;&#21253;(GWT)</title><link rel="stylesheet" href="../shared/css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="Seam - &#35821;&#22659;&#30456;&#20851;&#30340;&#32452;&#20214; [&#28385;&#27743;&#32418;20080327]"><link rel="up" href="index.html" title="Seam - &#35821;&#22659;&#30456;&#20851;&#30340;&#32452;&#20214; [&#28385;&#27743;&#32418;20080327]"><link rel="previous" href="remoting.html" title="Chapter&nbsp;21.&nbsp;Remoting"><link rel="next" href="spring.html" title="Chapter&nbsp;23.&nbsp;Spring Framework&#38598;&#25104;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;22.&nbsp;Seam&#21644;Google&#30340;Web&#24037;&#20855;&#21253;(GWT)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="remoting.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="spring.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="gwt"></a>Chapter&nbsp;22.&nbsp;Seam&#21644;Google&#30340;Web&#24037;&#20855;&#21253;(GWT)</h2></div></div><div></div></div><p>
    &#23545;&#20110;&#37027;&#20123;&#23425;&#24895;&#20351;&#29992;Google Web Toolkit&#65288;&#20197;&#19979;&#31616;&#31216;&#65306;GWT&#65289;&#21435;&#24320;&#21457;&#21160;&#24577;&#30340;AJAX&#30340;&#24212;&#29992;&#31243;&#24207;&#30340;&#20154;&#20204;&#26469;&#35828;&#65292;Seam&#25552;&#20379;&#20102;&#19968;&#20010;&#20801;&#35768;GWT widget&#30452;&#25509;&#19982;Seam&#32452;&#20214;&#20132;&#20114;&#30340;&#25972;&#21512;&#23618;&#12290;
  </p><p>
    &#20026;&#20102;&#20351;&#29992;GWT&#65292;&#25105;&#20204;&#20551;&#35774;&#20320;&#24050;&#32463;&#24456;&#29087;&#24713;GWT&#24037;&#20855; - &#26356;&#22810;&#20449;&#24687;&#21487;&#20197;&#22312; <a href="http://code.google.com/webtoolkit/" target="_top">http://code.google.com/webtoolkit/</a> &#20013;&#25214;&#21040;&#12290;
    &#26412;&#31456;&#23601;&#19981;&#21435;&#35299;&#37322;GWT&#22914;&#20309;&#24037;&#20316;&#20197;&#21450;&#22914;&#20309;&#20351;&#29992;&#20102;&#12290;
  </p><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13177"></a>22.1.&nbsp;&#37197;&#32622;</h2></div></div><div></div></div><p>
      &#22312;Seam&#24212;&#29992;&#31243;&#24207;&#20013;&#20351;&#29992;GWT&#24182;&#19981;&#38656;&#35201;&#29305;&#21035;&#30340;&#37197;&#32622;&#65292;&#20294;&#26159;Seam&#36164;&#28304;&#30340;servlet&#26159;&#24517;&#39035;&#23433;&#35013;&#30340;&#12290;&#26356;&#22810;&#35814;&#24773;&#35831;&#30475; <a href="configuration.html" title="Chapter&nbsp;25.&nbsp;Seam&#37197;&#32622;&#21644;Seam&#24212;&#29992;&#31243;&#24207;&#25171;&#21253;">Chapter&nbsp;25, <i>Seam&#37197;&#32622;&#21644;Seam&#24212;&#29992;&#31243;&#24207;&#25171;&#21253;</i></a> &#12290;
    </p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13184"></a>22.2.&nbsp;&#20934;&#22791;&#20320;&#30340;&#32452;&#20214;</h2></div></div><div></div></div><p>
      &#20934;&#22791;&#19968;&#20010;&#35201;&#36890;&#36807;GWT&#36827;&#34892;&#35843;&#29992;&#30340;Seam&#32452;&#20214;&#30340;&#31532;&#19968;&#27493;&#65292;&#26159;&#32473;&#20320;&#24819;&#35201;&#35843;&#29992;&#30340;&#26041;&#27861;&#21019;&#24314;&#21516;&#27493;&#21644;&#24322;&#27493;&#30340;&#26381;&#21153;&#25509;&#21475;&#12290;&#36825;&#20004;&#20010;&#25509;&#21475;&#37117;&#24212;&#35813;&#25193;&#23637;GWT&#25509;&#21475; <tt class="literal">com.google.gwt.user.client.rpc.RemoteService</tt> &#65306;
    </p><pre class="programlisting">  public interface MyService extends RemoteService
  {
    public String askIt(String question);
  }</pre><p>
      &#24322;&#27493;&#25509;&#21475;&#24212;&#35813;&#23436;&#20840;&#30456;&#21516;&#65292;&#38500;&#27492;&#20043;&#22806;&#65292;&#23427;&#36824;&#35201;&#32473;&#23427;&#22768;&#26126;&#30340;&#27599;&#19968;&#20010;&#26041;&#27861;&#21253;&#21547;&#19968;&#20010;&#39069;&#22806;&#30340; <tt class="literal">AsyncCallback</tt> &#21442;&#25968;&#65306;
    </p><pre class="programlisting">  public interface MyServiceAsync extends RemoteService
  {
    public void askIt(String question, AsyncCallback callback);
  }</pre><p>
      &#22312;&#36825;&#20010;&#33539;&#20363; <tt class="literal">MyServiceAsync</tt> &#20013;&#65292;&#24322;&#27493;&#25509;&#21475;&#23558;&#36890;&#36807;GWT&#23454;&#29616;&#65292;&#24182;&#19988;&#27704;&#36828;&#19981;&#24212;&#35813;&#30452;&#25509;&#23454;&#29616;&#12290;
    </p><p>
      &#19979;&#19968;&#27493;&#65292;&#26159;&#21019;&#24314;&#19968;&#20010;&#23454;&#29616;&#21516;&#27493;&#25509;&#21475;&#30340;Seam&#32452;&#20214;&#65306;
    </p><pre class="programlisting">  @Name("org.jboss.seam.example.remoting.gwt.client.MyService")
  public class ServiceImpl implements MyService
  {
    @WebRemote
    public String askIt(String question)
    {
      if (!validate(question))
      {
        throw new IllegalStateException("Hey, this shouldn't happen, I checked on the client, " +
               "but its always good to double check.");
      }
      return "42. Its the real question that you seek now.";
    }

    public boolean validate(String q)
    {
      ValidationUtility util = new ValidationUtility();
      return util.isValid(q);
    }
  }</pre><p>
      &#24212;&#35813;&#20570;&#25104;&#33021;&#36890;&#36807;GWT&#35775;&#38382;&#30340;&#37027;&#20123;&#26041;&#27861;&#65292;&#38656;&#35201;&#36890;&#36807;&#26631;&#35782; <tt class="literal">@WebRemote</tt> &#36827;&#34892;&#27880;&#35299;&#65292;&#36825;&#26159;&#25152;&#26377;&#33021;&#22815;&#36827;&#34892;Web&#36828;&#31243;&#35775;&#38382;&#30340;&#26041;&#27861;&#37117;&#35201;&#27714;&#30340;&#12290;
    </p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13215"></a>22.3.&nbsp;&#23558;GWT&#23567;&#32452;&#20214;&#25509;&#21040;Seam&#32452;&#20214;</h2></div></div><div></div></div><p>
      &#19979;&#19968;&#27493;&#65292;&#26159;&#32534;&#20889;&#19968;&#20010;&#23558;&#24322;&#27493;&#25509;&#21475;&#36820;&#22238;&#32473;&#32452;&#20214;&#30340;&#26041;&#27861;&#12290;&#36825;&#20010;&#26041;&#27861;&#21487;&#20197;&#25918;&#22312;&#23567;&#32452;&#20214;&#31867;&#37324;&#38754;&#65292;&#23558;&#34987;&#23567;&#32452;&#20214;&#29992;&#26469;&#33719;&#24471;&#19968;&#20010;&#23545;&#24322;&#27493;&#23458;&#25143;&#31471;&#23384;&#26681;&#65288;stub&#65289;&#30340;&#24341;&#29992;&#65306;
    </p><pre class="programlisting">   private MyServiceAsync getService()
   {
      String endpointURL = GWT.getModuleBaseURL() + "seam/resource/gwt";

      MyServiceAsync svc = (MyServiceAsync) GWT.create(MyService.class);
      ((ServiceDefTarget) svc).setServiceEntryPoint(endpointURL);
      return svc;
   }</pre><p>
       &#26368;&#21518;&#19968;&#27493;&#23601;&#26159;&#32534;&#20889;&#23567;&#32452;&#20214;&#20195;&#30721;&#65292;&#23427;&#22312;&#23458;&#25143;&#31471;&#23384;&#26681;&#19978;&#35843;&#29992;&#26041;&#27861;&#12290;&#20197;&#19979;&#20195;&#30721;&#21019;&#24314;&#19968;&#20010;&#31616;&#21333;&#30340;&#29992;&#25143;&#25509;&#21475;&#65292;&#21253;&#21547;label&#65288;&#26631;&#31614;&#65289;&#12289;text input&#65288;&#25991;&#26412;&#36755;&#20837;&#26694;&#65289;&#21644;&#19968;&#20010;button&#65288;&#25353;&#38062;&#65289;&#65306;
    </p><pre class="programlisting">
public class AskQuestionWidget extends Composite
{
   private AbsolutePanel panel = new AbsolutePanel();

   public AskQuestionWidget()
   {
      Label lbl = new Label("OK, what do you want to know?");
      panel.add(lbl);
      final TextBox box = new TextBox();
      box.setText("What is the meaning of life?");
      panel.add(box);
      Button ok = new Button("Ask");
      ok.addClickListener(new ClickListener()
      {
         public void onClick(Widget w)
         {
            ValidationUtility valid = new ValidationUtility();
            if (!valid.isValid(box.getText()))
            {
               Window.alert("A question has to end with a '?'");
            }
            else
            {
               askServer(box.getText());
            }
         }
      });
      panel.add(ok);

      initWidget(panel);
   }

   private void askServer(String text)
   {
      getService().askIt(text, new AsyncCallback()
      {
         public void onFailure(Throwable t)
         {
            Window.alert(t.getMessage());
         }

         public void onSuccess(Object data)
         {
            Window.alert((String) data);
         }
      });
   }

   ...
    </pre><p>
      &#24403;&#28857;&#20987;&#25353;&#38062;&#26102;&#65292;&#23427;&#23601;&#35843;&#29992; <tt class="literal">askServer()</tt> &#26041;&#27861;&#26469;&#20256;&#36882;&#36755;&#20837;&#26694;&#30340;&#20869;&#23481;&#65288;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#36824;&#25191;&#34892;&#20102;&#39564;&#35777;&#65292;&#20197;&#30830;&#20445;&#36755;&#20837;&#30340;&#26159;&#26377;&#25928;&#30340;&#38382;&#39064;&#65289;&#12290;&#36825;&#20010; <tt class="literal">askServer()</tt> &#26041;&#27861;&#33719;&#24471;&#19968;&#20010;&#23545;&#24322;&#27493;&#23458;&#25143;&#31471;&#23384;&#26681;&#30340;&#24341;&#29992;&#65288;&#30001; <tt class="literal">getService()</tt> &#26041;&#27861;&#36820;&#22238;&#65289;&#65292;&#24182;&#35843;&#29992; <tt class="literal">askIt()</tt> &#26041;&#27861;&#12290;&#36825;&#20010;&#32467;&#26524;&#65288;&#25110;&#32773;&#35843;&#29992;&#22833;&#36133;&#26102;&#30340;&#38169;&#35823;&#20449;&#24687;&#65289;&#26174;&#31034;&#22312;&#20197;&#19968;&#20010;&#35686;&#21578;&#31383;&#21475;&#20013;&#12290;
    </p><div class="mediaobject" align="center"><img src="images/gwt-helloworld.png" align="middle"></div><p>
      &#36825;&#20010;&#20363;&#23376;&#30340;&#23436;&#25972;&#20195;&#30721;&#21487;&#20197;&#22312;Seam&#21457;&#34892;&#21253;&#30340; <tt class="literal">examples/remoting/gwt</tt> &#20013;&#25214;&#21040;&#12290;
    </p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13250"></a>22.4.&nbsp;GWT Ant Targets</h2></div></div><div></div></div><p>
      &#23545;&#20110;GWT&#24212;&#29992;&#31243;&#24207;&#30340;&#21457;&#24067;&#65288;&#37096;&#32626;&#65289;&#26469;&#35828;&#65292;&#26377;&#19968;&#20010;&#32534;&#35793;&#25104;JavaScript&#30340;&#27493;&#39588;&#65288;&#23427;&#21387;&#32553;&#21644;&#28151;&#28102;&#20102;&#20195;&#30721;&#65289;&#12290;
      &#26377;&#19968;&#20010;Ant&#23454;&#29992;&#31243;&#24207;&#21487;&#20197;&#29992;&#26469;&#21462;&#20195;GWT&#25552;&#20379;&#30340;&#21629;&#20196;&#34892;&#25110;&#32773;GUI&#23454;&#29992;&#31243;&#24207;&#12290;
      &#20026;&#20102;&#20351;&#29992;&#36825;&#20010;&#21151;&#33021;&#65292;&#20320;&#19981;&#20165;&#22312;Ant classpath&#20013;&#35201;&#26377;Ant&#30340;&#20219;&#21153;jar&#21253;&#65292;&#36824;&#35201;&#19979;&#36733;GWT&#65288;&#26080;&#35770;&#24590;&#26679;&#65292;&#20320;&#22312;&#26412;&#26426;&#27169;&#24335;&#19979;&#26102;&#20063;&#20250;&#38656;&#35201;&#23427;&#65289;&#12290;
    </p><p>
      &#25509;&#19979;&#26469;&#22312;&#20320;&#30340;Ant&#25991;&#20214;&#20013;&#65288;&#22312;&#20320;&#30340;Ant&#25991;&#20214;&#39030;&#22836;&#38468;&#36817;&#65289;
    </p><pre class="programlisting">  &lt;taskdef uri="antlib:de.samaflost.gwttasks"
                resource="de/samaflost/gwttasks/antlib.xml"
                classpath="./lib/gwttasks.jar"/&gt;

  &lt;property file="build.properties"/&gt;</pre><p>
      &#21019;&#24314;&#19968;&#20010; <tt class="literal">build.properties</tt> &#25991;&#20214;&#65292;&#23427;&#21253;&#25324;&#20197;&#19979;&#20869;&#23481;&#65306;
    </p><pre class="programlisting">gwt.home=/gwt_home_dir</pre><p>
      &#36825;&#24403;&#28982;&#24212;&#35813;&#25351;&#21521;GWT&#30340;&#23433;&#35013;&#36335;&#24452;&#12290;&#28982;&#21518;&#29992;&#23427;&#21019;&#24314;&#19968;&#20010;Target&#65306;
    </p><pre class="programlisting">  &lt;!-- the following are are handy utilities for doing GWT development.
      To use GWT, you will of course need to download GWT seperately --&gt;
  &lt;target name="gwt-compile"&gt;
      &lt;!-- in this case, we are "re homing" the gwt generated stuff, so in this case
      we can only have one GWT module - we are doing this deliberately to keep the URL short --&gt;
      &lt;delete&gt;
          &lt;fileset dir="view"/&gt;
      &lt;/delete&gt;
      &lt;gwt:compile outDir="build/gwt"
          gwtHome="${gwt.home}"
          classBase="${gwt.module.name}"
          sourceclasspath="src"/&gt;
      &lt;copy todir="view"&gt;
          &lt;fileset dir="build/gwt/${gwt.module.name}"/&gt;
      &lt;/copy&gt;
  &lt;/target&gt;</pre><p>
      This target when called will compile the GWT application, and copy it to the specified directory (which would be
      in the <tt class="literal">webapp</tt> part of your war - remember GWT generates HTML and Javascript artifacts).  You
      never edit the resulting code that <tt class="literal">gwt-compile</tt> generates - you always edit in the GWT source
      directory.
      &#24403;&#36825;&#20010;Target&#34987;&#35843;&#29992;&#26102;&#65292;&#23558;&#32534;&#35793;GWT&#24212;&#29992;&#31243;&#24207;&#65292;&#24182;&#23558;&#23427;&#22797;&#21046;&#21040;&#25351;&#23450;&#30340;&#30446;&#24405;&#20013;&#65288;&#23427;&#20250;&#22312;&#20320;war&#30340; <tt class="literal">webapp</tt> &#37096;&#20998;&#20013; &#8212;&#8212; &#35760;&#20303;GWT&#29983;&#25104;HTML&#21644;Javascript&#24037;&#20214;&#65289;&#12290;
      &#20320;&#27704;&#36828;&#19981;&#29992;&#32534;&#36753; <tt class="literal">gwt-compile</tt> &#29983;&#25104;&#30340;&#32467;&#26524;&#20195;&#30721; &#8212;&#8212; &#20320;&#22987;&#32456;&#22312;GWT&#28304;&#36335;&#24452;&#20013;&#36827;&#34892;&#32534;&#36753;&#12290;
    </p><p>
      &#35760;&#20303;GWT&#26377;&#19968;&#20010;&#26412;&#26426;&#27169;&#24335;&#27983;&#35272;&#22120; &#8212;&#8212; &#20320;&#22312;&#29992;GWT&#24320;&#21457;&#26102;&#20351;&#29992;&#30340;&#24212;&#35813;&#23601;&#26159;&#23427;&#12290;
      &#22914;&#26524;&#20320;&#27809;&#26377;&#20351;&#29992;&#35813;&#27983;&#35272;&#22120;&#65292;&#32780;&#21482;&#26159;&#27599;&#27425;&#23545;&#23427;&#36827;&#34892;&#32534;&#35793;&#65292;&#37027;&#20320;&#23601;&#27809;&#26377;&#20805;&#20998;&#21033;&#29992;&#36825;&#20010;&#24037;&#20855;&#21253;&#65288;&#20107;&#23454;&#19978;&#65292;&#22914;&#26524;&#20320;&#26080;&#27861;&#25110;&#32773;&#27809;&#26377;&#20351;&#29992;&#26412;&#26426;&#27169;&#24335;&#27983;&#35272;&#22120;&#65292;&#25105;&#21482;&#33021;&#35828;&#20320;&#26681;&#26412;&#19981;&#24212;&#35813;&#20351;&#29992;GWT &#8212;&#8212; &#23427;&#38750;&#24120;&#26377;&#29992;&#65281;&#65289;
    </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="remoting.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="spring.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;21.&nbsp;Remoting&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;23.&nbsp;Spring Framework&#38598;&#25104;</td></tr></table></div></body></html>