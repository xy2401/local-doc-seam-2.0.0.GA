<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;18.&nbsp;&#24322;&#27493;&#21644;&#28040;&#24687;</title><link rel="stylesheet" href="../shared/css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="Seam - &#35821;&#22659;&#30456;&#20851;&#30340;&#32452;&#20214; [&#28385;&#27743;&#32418;20080327]"><link rel="up" href="index.html" title="Seam - &#35821;&#22659;&#30456;&#20851;&#30340;&#32452;&#20214; [&#28385;&#27743;&#32418;20080327]"><link rel="previous" href="mail.html" title="Chapter&nbsp;17.&nbsp;&#30005;&#23376;&#37038;&#20214;"><link rel="next" href="cache.html" title="Chapter&nbsp;19.&nbsp;&#32531;&#23384;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;18.&nbsp;&#24322;&#27493;&#21644;&#28040;&#24687;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mail.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="cache.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="jms"></a>Chapter&nbsp;18.&nbsp;&#24322;&#27493;&#21644;&#28040;&#24687;</h2></div></div><div></div></div><p>
	Seam&#20351;&#24471;&#24322;&#27493;&#25191;&#34892;&#19968;&#20010;&#26469;&#33258;Web&#35831;&#27714;&#30340;&#24037;&#20316;&#21464;&#24471;&#38750;&#24120;&#23481;&#26131;&#12290;&#24403;&#22823;&#22810;&#25968;&#20154;&#22312;Java EE&#37324;&#32771;&#34385;&#24322;&#27493;&#26102;&#65292;&#20182;&#20204;&#24819;&#21040;&#29992;JMS&#12290;
	&#22312;Seam&#20013;&#65292;&#36825;&#30830;&#23454;&#26159;&#19968;&#31181;&#35299;&#20915;&#26041;&#26696;&#65292;&#24403;&#20320;&#26377;&#20005;&#26684;&#21644;&#26126;&#30830;&#23450;&#20041;&#30340;QoS&#26381;&#21153;&#38656;&#27714;&#26102;&#65292;&#36825;&#26159;&#27491;&#30830;&#30340;&#12290;Seam&#21033;&#29992;Seam&#32452;&#20214;&#35753;&#21457;&#36865;&#21644;&#25509;&#25910;JMS&#28040;&#24687;&#26356;&#23481;&#26131;&#36827;&#34892;&#12290;
    </p><p>
	&#20294;&#26159;&#23545;&#20110;&#22810;&#25968;&#29992;&#20363;&#26469;&#35828;&#65292;&#29992;JMS&#26080;&#24322;&#20110;&#26432;&#40481;&#29992;&#29275;&#20992;&#12290;Seam&#23558;&#31616;&#21333;&#30340;&#24322;&#27493;&#26041;&#27861;&#21644;&#20107;&#20214;&#24212;&#29992;&#20998;&#23618;&#65292;&#32622;&#20110;&#20320;&#36873;&#25321;&#30340; <span class="emphasis"><em>dispatchers</em></span> &#20043;&#19978;&#12290;
    </p><div class="itemizedlist"><ul type="disc"><li><p>
				<tt class="literal">java.util.concurrent.ScheduledThreadPoolExecutor</tt> &#65288;&#40664;&#35748;&#65289;
            </p></li><li><p>
                EJB Timer Service &#65288;&#38024;&#23545; EJB 3.0 &#29615;&#22659;&#65289;
            </p></li><li><p>
                Quartz
            </p></li></ul></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e11835"></a>18.1.&nbsp;&#24322;&#27493;</h2></div></div><div></div></div><p>
		&#24322;&#27493;&#30340;&#20107;&#20214;&#21644;&#26041;&#27861;&#35843;&#29992;&#19982;&#24213;&#23618;&#30340;&#20998;&#37197;&#26426;&#21046;&#26377;&#30528;&#30456;&#21516;&#30340;&#26381;&#21153;&#26399;&#24453;&#36136;&#37327;&#12290;
		&#22522;&#20110; <tt class="literal">ScheduledThreadPoolExecutor</tt> &#30340;&#40664;&#35748;dispatcher&#25191;&#34892;&#24471;&#24456;&#22909;&#65292;&#20294;&#19981;&#25552;&#20379;&#23545;&#25345;&#20037;&#21270;&#24322;&#27493;&#20219;&#21153;&#30340;&#25903;&#25345;&#65292;&#22240;&#27492;&#19981;&#20445;&#35777;&#19968;&#39033;&#20219;&#21153;&#30495;&#27491;&#20250;&#34987;&#25191;&#34892;&#12290;
		&#22914;&#26524;&#20320;&#22312;&#19968;&#20010;&#25903;&#25345;EJB 3.0&#30340;&#29615;&#22659;&#20013;&#24037;&#20316;&#65292;&#24182;&#23558;&#19979;&#38754;&#36825;&#19968;&#34892;&#28155;&#21152;&#21040; <tt class="literal">components.xml</tt> &#20013;&#65306;
        </p><pre class="programlisting">&lt;async:timer-service-dispatcher/&gt;</pre><p>
		&#37027;&#20040;&#65292;&#20320;&#30340;&#24322;&#27493;&#20219;&#21153;&#23558;&#30001;&#23481;&#22120;&#30340;EJB&#23450;&#26102;&#26381;&#21153;&#22788;&#29702;&#12290;
		&#22914;&#26524;&#20320;&#19981;&#29087;&#24713;Timer&#26381;&#21153;&#65292;&#20063;&#19981;&#24517;&#25285;&#24515;&#65292;&#22914;&#26524;&#20320;&#24819;&#35201;&#22312;Seam&#20013;&#20351;&#29992;&#24322;&#27493;&#26041;&#27861;&#65292;&#24182;&#19981;&#38656;&#35201;&#19982;&#23427;&#30452;&#25509;&#20132;&#20114;&#12290;
		&#35201;&#20102;&#35299;&#19968;&#20214;&#37325;&#35201;&#30340;&#20107;&#24773;&#65306;&#20219;&#20309;&#22909;&#30340;EJB 3.0&#23454;&#29616;&#37117;&#23558;&#26377;&#20351;&#29992;&#25345;&#20037;&#21270;&#23450;&#26102;&#22120;&#30340;&#36873;&#25321;&#65292;&#23427;&#20026;&#20219;&#21153;&#26368;&#32456;&#24471;&#21040;&#22788;&#29702;&#25552;&#20379;&#20102;&#19968;&#20123;&#20445;&#35777;&#12290;
        </p><p>
		&#21478;&#19968;&#31181;&#36873;&#25321;&#26159;&#20351;&#29992;&#24320;&#28304;&#30340;Quartz&#24211;&#26469;&#31649;&#29702;&#24322;&#27493;&#30340;&#26041;&#27861;&#12290;
		&#20320;&#35201;&#23558;Quartz&#24211;JAR&#65288;&#22312; <tt class="literal">lib</tt> &#36335;&#24452;&#20013;&#65289;&#32465;&#23450;&#22312;&#20320;&#30340;EAR&#20013;&#65292;&#24182;&#22312; <tt class="literal">application.xml</tt> &#20013;&#23558;&#23427;&#22768;&#26126;&#25104;&#19968;&#20010;Java&#27169;&#22359;&#12290;
		&#21478;&#22806;&#65292;&#20320;&#36824;&#38656;&#35201;&#23558;&#19979;&#38754;&#30340;&#34892;&#28155;&#21152;&#21040; <tt class="literal">components.xml</tt> &#20013;&#26469;&#23433;&#35013;Quartz Dispatcher&#12290;
        </p><pre class="programlisting">&lt;async:quartz-dispatcher/&gt;</pre><p>
		Seam&#30340;API&#23545;&#20110;&#40664;&#35748;&#30340; <tt class="literal">ScheduledThreadPoolExecutor</tt> &#30340;Seam API&#65292;&#21450;EJB3 <tt class="literal">Timer</tt>&#19982;Quartz <tt class="literal">Scheduler</tt> &#22823;&#20307;&#30456;&#21516;&#12290;
		&#23427;&#20204;&#21487;&#20197;&#21482;&#26159;&#36890;&#36807;&#22312; <tt class="literal">components.xml</tt> &#20013;&#28155;&#21152;&#19968;&#34892;&#26469;&#36827;&#34892;&#8221;&#21363;&#25554;&#21363;&#29992;&#65288;plug and play&#65289;&#8220;&#12290;
        </p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e11877"></a>18.1.1.&nbsp;&#24322;&#27493;&#26041;&#27861;</h3></div></div><div></div></div><p>
			&#26368;&#31616;&#21333;&#30340;&#24418;&#24335;&#65292;&#19968;&#20010;&#24322;&#27493;&#30340;&#35843;&#29992;&#21482;&#26159;&#24322;&#27493;&#22320;&#22788;&#29702;&#26469;&#33258;&#35775;&#38382;&#32773;&#30340;&#26041;&#27861;&#35843;&#29992;&#65288;&#22312;&#19981;&#21516;&#30340;&#32447;&#31243;&#20013;&#65289;&#12290;
            &#24403;&#25105;&#20204;&#35201;&#36820;&#22238;&#19968;&#20010;&#21363;&#26102;&#21709;&#24212;&#32473;&#23458;&#25143;&#31471;&#26102;&#65292;&#36890;&#24120;&#20351;&#29992;&#19968;&#20010;&#24322;&#27493;&#35843;&#29992;&#65292;&#24182;&#35753;&#19968;&#20123;&#36153;&#26102;&#30340;&#24037;&#20316;&#22312;&#21518;&#21488;&#22788;&#29702;&#12290;
            &#27492;&#27169;&#24335;&#22312;&#20351;&#29992;AJAX&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#36816;&#34892;&#33391;&#22909;&#65292;&#22312;AJAX&#24212;&#29992;&#20013;&#23458;&#25143;&#31471;&#33021;&#22815;&#33258;&#21160;&#22320;&#20174;&#26381;&#21153;&#22120;&#19978;&#33719;&#24471;&#24037;&#20316;&#32467;&#26524;&#12290;
        	</p><p>
            &#23545;&#20110;EJB&#32452;&#20214;&#65292;&#25105;&#20204;&#22312;&#26412;&#22320;&#25509;&#21475;&#19978;&#36827;&#34892;&#27880;&#35299;&#65292;&#26469;&#25351;&#23450;&#26576;&#20010;&#26041;&#27861;&#35201;&#34987;&#24322;&#27493;&#22320;&#22788;&#29702;&#12290;
            </p><pre class="programlisting">@Local
public interface PaymentHandler
{
    @Asynchronous
    public void processPayment(Payment payment);
}</pre><p>
            &#65288;&#23545;&#20110;JavaBean&#32452;&#20214;&#65292;&#22914;&#26524;&#21916;&#27426;&#30340;&#35805;&#65292;&#25105;&#20204;&#21487;&#20197;&#27880;&#35299;&#32452;&#20214;&#23454;&#29616;&#31867;&#12290;&#65289;
            </p><p>
            &#24322;&#27493;&#30340;&#20351;&#29992;&#23545;&#20110;Bean&#31867;&#26469;&#35828;&#26159;&#36879;&#26126;&#30340;&#65306;
            </p><pre class="programlisting">@Stateless
@Name("paymentHandler")
public class PaymentHandlerBean implements PaymentHandler
{
    public void processPayment(Payment payment)
    {
        //do some work!
    }
}</pre><p>
            &#24182;&#19988;&#23545;&#23458;&#25143;&#31471;&#20063;&#26159;&#36879;&#26126;&#30340;&#65306;
            </p><pre class="programlisting">@Stateful
@Name("paymentAction")
public class CreatePaymentAction
{
    @In(create=true) PaymentHandler paymentHandler;
    @In Bill bill;

    public String pay()
    {
        paymentHandler.processPayment( new Payment(bill) );
        return "success";
    }
}</pre><p>
			&#24322;&#27493;&#26041;&#27861;&#22312;&#19968;&#20010;&#20840;&#26032;&#30340;&#20107;&#20214;&#19978;&#19979;&#25991;&#20013;&#22788;&#29702;&#65292;&#32780;&#19988;&#26080;&#27861;&#35775;&#38382;&#35843;&#29992;&#32773;&#30340;&#20250;&#35805;&#25110;&#23545;&#35805;&#19978;&#19979;&#25991;&#29366;&#24577;&#12290;
            &#28982;&#32780;&#65292;&#19994;&#21153;&#27969;&#31243;&#19978;&#19979;&#25991; <span class="emphasis"><em>&#24471;&#21040;&#20102;</em></span> &#20256;&#25773;&#12290;
            </p><p>
			&#24322;&#27493;&#26041;&#27861;&#35843;&#29992;&#21487;&#20197;&#21033;&#29992; <tt class="literal">@Duration</tt>&#12289;<tt class="literal">@Expiration</tt> &#21644; <tt class="literal">@IntervalDuration</tt>&#27880;&#35299;&#20026;&#21518;&#32493;&#30340;&#25191;&#34892;&#23450;&#26102;&#12290;
			</p><pre class="programlisting">@Local
public interface PaymentHandler
{
    @Asynchronous
    public void processScheduledPayment(Payment payment, @Expiration Date date);

    @Asynchronous
    public void processRecurringPayment(Payment payment, @Expiration Date date, @IntervalDuration Long interval)'
}</pre><pre class="programlisting">@Stateful
@Name("paymentAction")
public class CreatePaymentAction
{
    @In(create=true) PaymentHandler paymentHandler;
    @In Bill bill;

    public String schedulePayment()
    {
        paymentHandler.processScheduledPayment( new Payment(bill), bill.getDueDate() );
        return "success";
    }

    public String scheduleRecurringPayment()
    {
        paymentHandler.processRecurringPayment( new Payment(bill), bill.getDueDate(), ONE_MONTH );
        return "success";
    }
}</pre><p>
			&#23458;&#25143;&#31471;&#21644;&#26381;&#21153;&#31471;&#20004;&#32773;&#37117;&#21487;&#20197;&#35775;&#38382;&#19982;&#35843;&#29992;&#30456;&#20851;&#32852;&#30340; <tt class="literal">Timer</tt> &#23545;&#35937;&#12290;&#24403;&#20351;&#29992;EJB3 Dispatcher&#26102;&#65292; The <tt class="literal">Timer</tt> &#23545;&#35937;&#20250;&#26174;&#31034;&#22312;&#19979;&#38754;&#12290;&#23545;&#20110;&#40664;&#35748;&#30340;<tt class="literal">ScheduledThreadPoolExecutor</tt>&#65292;&#36820;&#22238;&#30340;&#26159;JDK&#30340;&#23545;&#35937;<tt class="literal">Future</tt>&#12290;&#23545;&#20110;Quartz Dispatcher&#65292;&#36820;&#22238;<tt class="literal">QuartzTriggerHandle</tt>&#65292;&#25105;&#20204;&#20250;&#22312;&#19979;&#37096;&#20998;&#23545;&#27492;&#36827;&#34892;&#35752;&#35770;&#12290;
			</p><pre class="programlisting">@Local
public interface PaymentHandler
{
    @Asynchronous
    public Timer processScheduledPayment(Payment payment, @Expiration Date date);
}</pre><pre class="programlisting">@Stateless
@Name("paymentHandler")
public class PaymentHandlerBean implements PaymentHandler
{
    @In Timer timer;

    public Timer processScheduledPayment(Payment payment, @Expiration Date date)
    {
        //do some work!

        return timer; // &#27880;&#24847;&#36820;&#22238;&#20540;&#34987;&#23436;&#20840;&#24573;&#30053;
    }

}</pre><pre class="programlisting">@Stateful
@Name("paymentAction")
public class CreatePaymentAction
{
    @In(create=true) PaymentHandler paymentHandler;
    @In Bill bill;

    public String schedulePayment()
    {
        Timer timer = paymentHandler.processScheduledPayment( new Payment(bill), bill.getDueDate() );
        return "success";
    }
}</pre><p>
			&#24322;&#27493;&#26041;&#27861;&#19981;&#33021;&#36820;&#22238;&#20219;&#20309;&#20854;&#23427;&#20540;&#32473;&#35843;&#29992;&#32773;&#12290;
			</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e11941"></a>18.1.2.&nbsp;&#21253;&#21547;Quartz Dispatcher&#30340;&#24322;&#27493;&#26041;&#27861;</h3></div></div><div></div></div><p>
            Quartz dispatcher&#65288;&#23427;&#30340;&#23433;&#35013;&#26041;&#27861;&#35831;&#35265;&#21069;&#25991;&#65289;&#20801;&#35768;&#20320;&#20351;&#29992; <tt class="literal">@Asynchronous</tt>&#12289;<tt class="literal">@Duration</tt>&#12289;<tt class="literal">@Expiration</tt> &#21644; <tt class="literal">@IntervalDuration</tt> &#27880;&#35299;&#12290;&#20294;&#23427;&#36824;&#26377;&#19968;&#20123;&#20854;&#20182;&#30340;&#24378;&#22823;&#21151;&#33021;&#12290;Quartz dispatcher&#36824;&#25903;&#25345;&#19977;&#31181;&#26032;&#27880;&#35299;&#12290;
            </p><p>
			<tt class="literal">@FinalExpiration</tt> &#27880;&#35299;&#25351;&#23450;&#19968;&#20010;&#37325;&#29616;&#20219;&#21153;&#30340;&#32456;&#27490;&#26085;&#26399;&#12290;
			</p><pre class="programlisting">
    // Defines the method in the "processor" component
    @Asynchronous
    public QuartzTriggerHandle schedulePayment(@Expiration Date when,
                                 @IntervalDuration Long interval,
                                 @FinalExpiration Date endDate,
                                 Payment payment)
    {
        // do the repeating or long running task until endDate
    }

    ... ...

    // Schedule the task in the business logic processing code
    // Starts now, repeats every hour, and ends on May 10th, 2010
    Calendar cal = Calendar.getInstance ();
    cal.set (2010, Calendar.MAY, 10);
    processor.schedulePayment(new Date(), 60*60*1000, cal.getTime(), payment);
</pre><p>
			&#27880;&#24847;&#35813;&#26041;&#27861;&#36820;&#22238; <tt class="literal">QuartzTriggerHandle</tt> &#23545;&#35937;&#65292;&#20320;&#20197;&#21518;&#21487;&#20197;&#29992;&#23427;&#26469;&#20013;&#27490;&#12289;&#26242;&#20572;&#21644;&#24674;&#22797;&#23450;&#26102;&#22120;&#12290;
			<tt class="literal">QuartzTriggerHandle</tt> &#23545;&#35937;&#26159;&#21487;&#24207;&#21015;&#21270;&#30340;&#65292;&#22240;&#27492;&#65292;&#22914;&#26524;&#20320;&#38656;&#35201;&#20445;&#30041;&#26356;&#20037;&#19968;&#28857;&#65292;&#21487;&#20197;&#25226;&#23427;&#23384;&#21040;&#25968;&#25454;&#24211;&#20013;&#12290;
			</p><pre class="programlisting">QuartzTriggerHandle handle =
         processor.schedulePayment(payment.getPaymentDate(),
                                   payment.getPaymentCron(),
                                   payment);
        payment.setQuartzTriggerHandle( handle );
        // Save payment to DB

        // later ...

        // Retrieve payment from DB
        // Cancel the remaining scheduled tasks
        payment.getQuartzTriggerHandle().cancel();
</pre><p>
			<tt class="literal">@IntervalCron</tt> &#27880;&#35299;&#25903;&#25345;Unix cron&#35821;&#27861;&#30340;&#20219;&#21153;&#35843;&#24230;&#12290;&#20363;&#22914;&#65292;&#19979;&#38754;&#30340;&#24322;&#27493;&#26041;&#27861;&#22312;&#19977;&#26376;&#20221;&#27599;&#21608;&#19977;&#30340;2:10pm&#21644;2:44pm&#36816;&#34892;&#12290;
			</p><pre class="programlisting">
    // Define the method
    @Asynchronous
    public QuartzTriggerHandle schedulePayment(@Expiration Date when,
                                 @IntervalCron String cron,
                                 Payment payment)
    {
        // do the repeating or long running task
    }

    ... ...

    // Schedule the task in the business logic processing code
    QuartzTriggerHandle handle =
      processor.schedulePayment(new Date(), "0 10,44 14 ? 3 WED", payment);
</pre><p>
			<tt class="literal">@IntervalBusinessDay</tt> &#27880;&#35299;&#25903;&#25345;&#22312;&#8221;&#31532;n&#20010;Business Day&#8220;&#35843;&#29992;&#12290;
			&#20363;&#22914;&#65292;&#19979;&#38754;&#30340;&#24322;&#27493;&#26041;&#27861;&#22312;&#27599;&#20010;&#26376;&#30340;&#31532;2&#20010;business day&#30340;14:00&#36816;&#34892;&#12290;
			&#40664;&#35748;&#26102;&#65292;&#23427;&#20174;business day&#20013;&#25490;&#38500;&#20102;2010&#24180;&#20043;&#21069;&#30340;&#25152;&#26377;&#21608;&#26411;&#21644;&#31859;&#22269;&#32852;&#37030;&#20551;&#26399;&#12290;
			</p><pre class="programlisting">
    // Define the method
    @Asynchronous
    public QuartzTriggerHandle schedulePayment(@Expiration Date when,
                                 @IntervalBusinessDay NthBusinessDay nth,
                                 Payment payment)
    {
        // do the repeating or long running task
    }

    ... ...

    // Schedule the task in the business logic processing code
    QuartzTriggerHandle handle =
      processor.schedulePayment(new Date(),
          new NthBusinessDay(2, "14:00", WEEKLY), payment);
</pre><p>
			<tt class="literal">NthBusinessDay</tt> &#23545;&#35937;&#21253;&#21547;&#35843;&#29992;&#35302;&#21457;&#22120;&#30340;&#37197;&#32622;&#12290;
			&#20320;&#21487;&#20197;&#36890;&#36807; <tt class="literal">additionalHolidays</tt> &#23646;&#24615;&#25351;&#23450;&#26356;&#22810;&#30340;&#20551;&#26399;&#65288;&#20363;&#22914;&#65292;&#20844;&#21496;&#20551;&#26399;&#12289;&#38750;&#32654;&#22269;&#30340;&#20551;&#26399;&#31561;&#31561;&#12290;&#65289;
			</p><pre class="programlisting">
public class NthBusinessDay implements Serializable
{
      int n;
      String fireAtTime;
      List &lt;Date&gt; additionalHolidays;
      BusinessDayIntervalType interval;
      boolean excludeWeekends;
      boolean excludeUsFederalHolidays;

      public enum BusinessDayIntervalType { WEEKLY, MONTHLY, YEARLY }

      public NthBusinessDay ()
      {
        n = 1;
        fireAtTime = "12:00";
        additionalHolidays = new ArrayList &lt;Date&gt; ();
        interval = BusinessDayIntervalType.WEEKLY;
        excludeWeekends = true;
        excludeUsFederalHolidays = true;
      }
      ... ...
}
</pre><p>
			<tt class="literal">@IntervalDuration</tt>&#12289;<tt class="literal">@IntervalCron</tt> &#21644; <tt class="literal">@IntervalNthBusinessDay</tt> &#27880;&#35299;&#30456;&#20114;&#25490;&#26021;&#12290;
			&#22914;&#26524;&#25226;&#23427;&#20204;&#29992;&#22312;&#21516;&#19968;&#20010;&#26041;&#27861;&#20013;&#65292;&#23601;&#20250;&#25243;&#20986; <tt class="literal">RuntimeException</tt>&#12290;
			</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12013"></a>18.1.3.&nbsp;&#24322;&#27493;&#20107;&#20214;</h3></div></div><div></div></div><p>
			&#32452;&#20214;&#39537;&#21160;&#30340;&#20107;&#20214;&#20063;&#21487;&#20197;&#26159;&#24322;&#27493;&#30340;&#12290;
			&#20026;&#20102;&#32473;&#24322;&#27493;&#22788;&#29702;&#25552;&#20986;&#20107;&#20214;&#65292;&#21482;&#35201;&#35843;&#29992; <tt class="literal">Events</tt> &#31867;&#30340; <tt class="literal">raiseAsynchronousEvent()</tt> &#26041;&#27861;&#23601;&#21487;&#20197;&#20102;&#12290;
			&#35201;&#23433;&#25490;&#19968;&#20010;&#23450;&#26102;&#30340;&#20107;&#20214;&#65292;&#35201;&#35843;&#29992; <tt class="literal">raiseTimedEvent()</tt> &#30340;&#19968;&#20010;&#26041;&#27861;&#65292;&#24182;&#20256;&#36882;&#19968;&#20010; <span class="emphasis"><em>schedule</em></span> &#23545;&#35937;
			&#65288;&#23545;&#20110;&#40664;&#35748;&#30340;dispatcher&#25110;&#32773;&#23450;&#26102;&#26381;&#21153;dispatcher&#65292;&#35201;&#20351;&#29992; <tt class="literal">TimerSchedule</tt>&#65289;&#12290;
			&#32452;&#20214;&#21487;&#20197;&#29992;&#27491;&#24120;&#26041;&#24335;&#35266;&#23519;&#24322;&#27493;&#20107;&#20214;&#65292;&#20294;&#26159;&#35201;&#35760;&#20303;&#65292;&#21482;&#26377;&#19994;&#21153;&#22788;&#29702;&#19978;&#19979;&#25991;&#25165;&#34987;&#20256;&#25773;&#21040;&#24322;&#27493;&#32447;&#31243;&#19978;&#12290;
            </p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e12033"></a>18.2.&nbsp;Seam&#20013;&#30340;&#28040;&#24687;</h2></div></div><div></div></div><p>
		Seam&#35753;JMS&#28040;&#24687;&#21457;&#36865;&#21040;Seam&#32452;&#20214;&#21644;&#20174;Seam&#32452;&#20214;&#25509;&#25910;&#21464;&#24471;&#24456;&#23481;&#26131;&#12290;
		</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12038"></a>18.2.1.&nbsp;&#37197;&#32622;</h3></div></div><div></div></div><p>
			&#20026;&#20102;&#32473;&#21457;&#36865;JMS&#28040;&#24687;&#37197;&#32622;Seam&#30340;&#22522;&#30784;&#32467;&#26500;&#65292;&#20320;&#38656;&#35201;&#21578;&#35785;Seam&#20851;&#20110;&#20219;&#20309;&#20320;&#24819;&#21457;&#36865;&#28040;&#24687;&#21040;&#30340;&#20027;&#39064;&#65288;Topic&#65289;&#21644;&#38431;&#21015;&#65288;Queue&#65289;&#65292;&#24182;&#19988;&#20063;&#35201;&#21578;&#35785;Seam&#21040;&#21738;&#37324;&#23547;&#25214; <tt class="literal">QueueConnectionFactory</tt> &#21644;&#65295;&#25110; <tt class="literal">TopicConnectionFactory</tt>&#12290;
        </p><p>
            Seam&#40664;&#35748;&#20351;&#29992; <tt class="literal">UIL2ConnectionFactory</tt>&#65292;&#23427;&#26159;&#20351;&#29992;JBossMQ&#26102;&#24120;&#29992;&#30340;&#36830;&#25509;&#24037;&#21378;&#12290;
            &#22914;&#26524;&#20320;&#27491;&#20351;&#29992;&#20854;&#20182;&#30340;JMS&#25552;&#20379;&#32773;&#65292;&#23601;&#38656;&#35201;&#22312; <tt class="literal">seam.properties</tt>&#12289;<tt class="literal">web.xml</tt> &#25110; <tt class="literal">components.xml</tt> &#25991;&#20214;&#20013;&#35774;&#32622;&#19968;&#20010;&#25110;&#20004;&#20010; <tt class="literal">queueConnection.queueConnectionFactoryJndiName</tt> &#21644; <tt class="literal">topicConnection.topicConnectionFactoryJndiName</tt>&#12290;
        </p><p>
            &#20320;&#20063;&#38656;&#35201;&#22312; <tt class="literal">components.xml</tt> &#25991;&#20214;&#20013;&#21015;&#20986;&#20027;&#39064;&#65288;Topic&#65289;&#21644;&#38431;&#21015;&#65288;Queue&#65289;&#65292;&#26469;&#23433;&#35013;Seam&#21463;&#25511;&#30340; <tt class="literal">TopicPublisher</tt> &#21644; <tt class="literal">QueueSender</tt>&#65306;
        </p><pre class="programlisting">&lt;jms:managed-topic-publisher name="stockTickerPublisher" auto-create="true" topic-jndi-name="topic/stockTickerTopic"/&gt;

&lt;jms:managed-queue-sender name="paymentQueueSender" auto-create="true" queue-jndi-name="queue/paymentQueue"/&gt;</pre></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12082"></a>18.2.2.&nbsp;&#21457;&#36865;&#28040;&#24687;</h3></div></div><div></div></div><p>
            &#29616;&#22312;&#65292;&#20320;&#21487;&#20197;&#27880;&#20837;&#19968;&#20010;JMS <tt class="literal">TopicPublisher</tt> &#21644; <tt class="literal">TopicSession</tt> &#21040;&#20219;&#20309;&#32452;&#20214;&#37324;&#65306;
            </p><pre class="programlisting">@In
private TopicPublisher stockTickerPublisher;
@In
private TopicSession topicSession;

public void publish(StockPrice price) {
      try
      {
         stockTickerPublisher.publish( topicSession.createObjectMessage(price) );
      }
      catch (Exception ex)
      {
         throw new RuntimeException(ex);
      }
}</pre><p>&#25110;&#29992;&#26469;&#21516;Queue&#19968;&#36215;&#20351;&#29992;</p><pre class="programlisting">@In
private QueueSender paymentQueueSender;
@In
private QueueSession queueSession;

public void publish(Payment payment) {
      try
      {
         paymentQueueSender.send( queueSession.createObjectMessage(payment) );
      }
      catch (Exception ex)
      {
         throw new RuntimeException(ex);
      }
}</pre></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12099"></a>18.2.3.&nbsp;&#21033;&#29992;&#28040;&#24687;&#39537;&#21160;Bean&#25509;&#25910;&#28040;&#24687;</h3></div></div><div></div></div><p>
			&#20320;&#21487;&#20197;&#21033;&#29992;&#20219;&#20309;EJB3&#28040;&#24687;&#39537;&#21160;Bean&#26469;&#22788;&#29702;&#28040;&#24687;&#12290;
            &#28040;&#24687;&#39537;&#21160;Bean&#29978;&#33267;&#21487;&#20197;&#26159;Seam&#32452;&#20214;&#65292;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#23427;&#21487;&#33021;&#27880;&#20837;&#20854;&#20182;&#20107;&#20214;&#21644;&#24212;&#29992;&#31243;&#24207;&#20316;&#29992;&#22495;&#30340;Seam&#32452;&#20214;&#12290;
        </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12104"></a>18.2.4.&nbsp;&#22312;&#23458;&#25143;&#31471;&#25509;&#25910;&#28040;&#24687;</h3></div></div><div></div></div><p>Seam Remoting&#20801;&#35768;&#20320;&#22312;&#23458;&#25143;&#31471;&#30340;JavaScript&#20195;&#30721;&#20013;&#35746;&#38405;JMS&#20027;&#39064;&#65288;Topic&#65289;&#12290;&#36825;&#20010;&#22312;&#19979;&#19968;&#31456;&#37324;&#35762;&#36848;&#12290;
        </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="cache.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;17.&nbsp;&#30005;&#23376;&#37038;&#20214;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;19.&nbsp;&#32531;&#23384;</td></tr></table></div></body></html>