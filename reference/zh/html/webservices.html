<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;20.&nbsp;Web Services</title><link rel="stylesheet" href="../shared/css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="Seam - &#35821;&#22659;&#30456;&#20851;&#30340;&#32452;&#20214; [&#28385;&#27743;&#32418;20080327]"><link rel="up" href="index.html" title="Seam - &#35821;&#22659;&#30456;&#20851;&#30340;&#32452;&#20214; [&#28385;&#27743;&#32418;20080327]"><link rel="previous" href="cache.html" title="Chapter&nbsp;19.&nbsp;&#32531;&#23384;"><link rel="next" href="remoting.html" title="Chapter&nbsp;21.&nbsp;Remoting"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;20.&nbsp;Web Services</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="cache.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="remoting.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="webservices"></a>Chapter&nbsp;20.&nbsp;Web Services</h2></div></div><div></div></div><p>
    Seam&#19982;JBossWS&#25972;&#21512;&#65292;&#26377;&#21161;&#20110;&#26631;&#20934;&#30340;JEE Web Services&#23436;&#20840;&#21033;&#29992;Seam&#19978;&#19979;&#25991;&#26694;&#26550;&#30340;&#20248;&#21183;&#65292;&#21253;&#25324;&#25903;&#25345;&#23545;&#35805;&#30340;Web Services&#12290;
    &#26412;&#31456;&#27010;&#36848;&#24110;&#21161;Web Services&#22312;Sema&#29615;&#22659;&#20869;&#37096;&#36816;&#34892;&#25152;&#38656;&#35201;&#30340;&#27493;&#39588;&#12290;
	</p><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e12243"></a>20.1.&nbsp;&#37197;&#32622;&#21644;&#25171;&#21253;</h2></div></div><div></div></div><p>
    &#20026;&#20102;&#20801;&#35768;Seam&#25318;&#25130;Web Service&#35831;&#27714;&#65292;&#20197;&#20415;&#33021;&#22815;&#20026;&#35813;&#35831;&#27714;&#21019;&#24314;&#24517;&#35201;&#30340;Seam&#19978;&#19979;&#25991;&#65292;&#24517;&#39035;&#37197;&#32622;&#19968;&#31181;&#29305;&#27530;&#30340;SOAP&#22788;&#29702;&#22120;&#65307;
    <tt class="literal">org.jboss.seam.webservice.SOAPRequesHandler</tt> &#26159;&#19968;&#31181; <tt class="literal">SOAPHandler</tt> &#23454;&#29616;&#65292;&#23427;&#23436;&#25104;&#22312;&#19968;&#20010;Web Service&#35831;&#27714;&#33539;&#22260;&#26399;&#38388;&#31649;&#29702;Seam&#29983;&#21629;&#21608;&#26399;&#30340;&#24037;&#20316;&#12290;
    &#23558;&#19968;&#20010;&#39033;&#30446;&#37197;&#32622;&#20026;&#20351;&#29992;&#36825;&#20010;&#22788;&#29702;&#22120;&#30340;&#26368;&#23481;&#26131;&#26041;&#27861;&#26159;&#65292;&#23558;&#19968;&#20010;&#31216;&#20316; <tt class="literal">standard-jaxws-endpoint-config.xml</tt> &#30340;&#25991;&#20214;&#25918;&#21040;&#21253;&#21547;Web Service&#31867;&#30340; <tt class="literal">jar</tt> &#25991;&#20214;&#30340; <tt class="literal">META-INF</tt> &#36335;&#24452;&#19979;&#12290;
    &#36825;&#20010;&#25991;&#20214;&#21253;&#21547;&#19979;&#21015;SOAP&#22788;&#29702;&#22120;&#37197;&#32622;&#65306;
    </p><pre class="programlisting">&lt;jaxws-config xmlns="urn:jboss:jaxws-config:2.0" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xmlns:javaee="http://java.sun.com/xml/ns/javaee"
              xsi:schemaLocation="urn:jboss:jaxws-config:2.0 jaxws-config_2_0.xsd"&gt;
   &lt;endpoint-config&gt;
      &lt;config-name&gt;Seam WebService Endpoint&lt;/config-name&gt;
      &lt;pre-handler-chains&gt;
         &lt;javaee:handler-chain&gt;
            &lt;javaee:protocol-bindings&gt;##SOAP11_HTTP&lt;/javaee:protocol-bindings&gt;
            &lt;javaee:handler&gt;
               &lt;javaee:handler-name&gt;SOAP Request Handler&lt;/javaee:handler-name&gt;
               &lt;javaee:handler-class&gt;org.jboss.seam.webservice.SOAPRequestHandler&lt;/javaee:handler-class&gt;
            &lt;/javaee:handler&gt;
         &lt;/javaee:handler-chain&gt;
      &lt;/pre-handler-chains&gt;
   &lt;/endpoint-config&gt;
&lt;/jaxws-config&gt;</pre></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e12265"></a>20.2.&nbsp;&#23545;&#35805;&#30340;Web Services</h2></div></div><div></div></div><p>
    &#37027;&#20040;&#23545;&#35805;&#22312;Web Service&#35831;&#27714;&#20043;&#38388;&#22914;&#20309;&#20256;&#25773;&#21602;&#65311;
    Seam&#20351;&#29992;&#19968;&#20010;&#22312;SOAP&#35831;&#27714;&#21644;&#21709;&#24212;&#28040;&#24687;&#20013;&#37117;&#26377;&#30340;SOAP&#26631;&#22836;&#20803;&#32032;&#65292;&#23558;&#23545;&#35805;ID&#20174;&#28040;&#36153;&#32773;&#20256;&#36755;&#21040;&#26381;&#21153;&#65292;&#24182;&#20877;&#20256;&#22238;&#26469;&#12290;
    &#19979;&#38754;&#26159;&#19968;&#20010;&#21253;&#21547;&#23545;&#35805;ID&#30340;Web Service&#35831;&#27714;&#30340;&#20363;&#23376;&#65306;
    </p><pre class="programlisting">&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
    xmlns:seam="http://seambay.example.seam.jboss.org/"&gt;
  &lt;soapenv:Header&gt;
    &lt;seam:conversationId xmlns:seam='http://www.jboss.org/seam/webservice'&gt;2&lt;/seam:conversationId&gt;
  &lt;/soapenv:Header&gt;
  &lt;soapenv:Body&gt;
    &lt;seam:confirmAuction/&gt;
  &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;    
    </pre><p>
    &#23601;&#22914;&#20320;&#22312;&#19978;&#38754;&#30340;SOAP&#28040;&#24687;&#20013;&#25152;&#35265;&#65292;&#22312;&#21253;&#21547;&#35831;&#27714;&#30340;&#23545;&#35805;ID&#65288;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#26159;<tt class="literal">2</tt>&#65289;&#30340;SOAP&#22836;&#20869;&#37096;&#65292;&#26377;&#19968;&#20010; <tt class="literal">conversationId</tt> &#20803;&#32032;&#65292;&#36951;&#25022;&#30340;&#26159;&#65292;&#30001;&#20110;Web Services&#21487;&#33021;&#34987;&#20197;&#19981;&#21516;&#35821;&#35328;&#32534;&#20889;&#30340;&#19981;&#21516;Web Service&#23458;&#25143;&#31471;&#28040;&#36153;&#65292;&#22240;&#27492;&#22312;&#20934;&#22791;&#29992;&#20110;&#21333;&#20010;&#23545;&#35805;&#33539;&#22260;&#20043;&#20869;&#30340;&#21333;&#29420;Web Services&#20043;&#38388;&#23454;&#29616;&#23545;&#35805;ID&#20256;&#25773;&#65292;&#30001;&#24320;&#21457;&#20154;&#21592;&#20915;&#23450;&#12290;
    </p><p>
    &#35201;&#27880;&#24847;&#30340;&#19968;&#20214;&#37325;&#35201;&#20107;&#24773;&#26159;&#65292;<tt class="literal">conversationId</tt> &#22836;&#20803;&#32032;&#24517;&#39035;&#28385;&#36275; <tt class="literal">http://www.jboss.org/seam/webservice</tt> &#30340;&#21629;&#21517;&#31354;&#38388;&#26465;&#20214;&#65292;&#21542;&#21017;Seam&#23558;&#26080;&#27861;&#20174;&#35831;&#27714;&#20013;&#35835;&#21462;&#23545;&#35805;ID&#12290;&#20197;&#19979;&#26159;&#23545;&#19978;&#36848;&#35831;&#27714;&#28040;&#24687;&#21709;&#24212;&#30340;&#19968;&#20010;&#20363;&#23376;&#65306;
    </p><pre class="programlisting">&lt;env:Envelope xmlns:env='http://schemas.xmlsoap.org/soap/envelope/'&gt;
  &lt;env:Header&gt;
    &lt;seam:conversationId xmlns:seam='http://www.jboss.org/seam/webservice'&gt;2&lt;/seam:conversationId&gt;
  &lt;/env:Header&gt;
  &lt;env:Body&gt;
    &lt;confirmAuctionResponse xmlns="http://seambay.example.seam.jboss.org/"/&gt;
  &lt;/env:Body&gt;
&lt;/env:Envelope&gt;    
    </pre><p>
    &#22914;&#20320;&#25152;&#35265;&#65292;&#21709;&#24212;&#28040;&#24687;&#21253;&#21547;&#19982;&#35831;&#27714;&#30456;&#21516;&#30340; <tt class="literal">conversationId</tt> &#20803;&#32032;&#12290;
    </p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12295"></a>20.2.1.&nbsp;&#24314;&#35758;&#31574;&#30053;</h3></div></div><div></div></div><p>
      &#22240;&#20026;Web Services&#24517;&#39035;&#34987;&#23454;&#29616;&#20026;&#19968;&#20010;&#26080;&#29366;&#24577;&#30340;&#20250;&#35805;Bean&#25110;&#32773;POJO&#65292;&#23545;&#20110;&#23545;&#35805;&#30340;Web Services&#65292;&#24314;&#35758;&#29992;Web Service&#20805;&#24403;&#19968;&#20010;&#23545;&#35805;Seam&#32452;&#20214;&#30340;&#22806;&#35266;&#65288;facade&#65289;&#12290;
      </p><div class="mediaobject" align="center"><img src="images/ws-strategy.png" align="middle"></div><p>
      &#22914;&#26524;Web Service&#26159;&#20316;&#20026;&#26080;&#29366;&#24577;&#20250;&#35805;Bean&#32534;&#20889;&#30340;&#65292;&#37027;&#23427;&#20063;&#21487;&#33021;&#36890;&#36807;&#25552;&#20379;&#19968;&#20010; <tt class="literal">@Name</tt>&#65292;&#25226;&#23427;&#21464;&#25104;&#19968;&#20010;Seam&#32452;&#20214;&#12290;
      &#36825;&#20040;&#20570;&#20801;&#35768;Seam&#30340;&#21452;&#21521;&#27880;&#20837;&#65288;&#21644;&#20854;&#23427;&#65289;&#29305;&#24615;&#22312;Web Service&#31867;&#33258;&#36523;&#20013;&#20351;&#29992;&#12290;
      </p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e12310"></a>20.3.&nbsp;Web Servic&#33539;&#20363;</h2></div></div><div></div></div><p>
    &#35753;&#25105;&#20204;&#27983;&#35272;&#19968;&#20010;Web Service&#30340;&#20363;&#23376;&#12290;
    &#26412;&#33410;&#20013;&#30340;&#20195;&#30721;&#20840;&#37096;&#26469;&#33258;Seam&#30340; <tt class="literal">/examples</tt> &#30446;&#24405;&#19979;&#30340;seamBay&#33539;&#20363;&#24212;&#29992;&#31243;&#24207;&#65292;&#24182;&#36981;&#24490;&#21069;&#19968;&#33410;&#20013;&#25152;&#36848;&#30340;&#24314;&#35758;&#31574;&#30053;&#12290;
    &#35753;&#25105;&#20204;&#20808;&#26469;&#30475;&#30475;Web Service&#31867;&#21644;&#23427;&#30340;&#20854;&#20013;&#19968;&#20010;Web Service&#26041;&#27861;&#65306;
    </p><pre class="programlisting">@Stateless
@WebService(name = "AuctionService", serviceName = "AuctionService")
public class AuctionService implements AuctionServiceRemote
{           
   @WebMethod
   public boolean login(String username, String password)
   {
      Identity.instance().setUsername(username);
      Identity.instance().setPassword(password);
      Identity.instance().login();
      return Identity.instance().isLoggedIn();
   }
   
   // snip
}</pre><p>
    &#22914;&#20320;&#25152;&#35265;&#65292;&#25105;&#20204;&#30340;Web Service&#26159;&#19968;&#20010;&#26080;&#29366;&#24577;&#30340;&#20250;&#35805;Bean&#65292;&#24182;&#22914;JSR-181&#25152;&#35268;&#23450;&#30340;&#65292;&#21033;&#29992; <tt class="literal">javax.jws</tt> &#21253;&#20013;&#30340;JWS&#27880;&#35299;&#36827;&#34892;&#27880;&#35299;&#12290;
    <tt class="literal">@WebService</tt> &#27880;&#35299;&#21578;&#35785;&#23481;&#22120;&#65292;&#36825;&#20010;&#31867;&#23454;&#29616;&#19968;&#20010;Web Service&#65292;&#19988; <tt class="literal">login()</tt> &#26041;&#27861;&#20013;&#30340; <tt class="literal">@WebMethod</tt> &#27880;&#35299;&#23558;&#35813;&#26041;&#27861;&#24403;&#25104;&#26159;&#19968;&#20010;Web Service&#26041;&#27861;&#12290;
    <tt class="literal">@WebService</tt> &#27880;&#35299;&#20013;&#30340; <tt class="literal">name</tt> &#21644; <tt class="literal">serviceName</tt> &#23646;&#24615;&#26159;&#21487;&#36873;&#30340;&#12290;
    </p><p>
    &#26681;&#25454;&#35268;&#33539;&#35201;&#27714;&#65292;&#35201;&#26292;&#38706;&#20316;&#20026;Web Service&#26041;&#27861;&#30340;&#27599;&#20010;&#26041;&#27861;&#20063;&#37117;&#24517;&#39035;&#22312;Web Service&#31867;&#30340;&#36828;&#31243;&#25509;&#21475;&#36827;&#34892;&#22768;&#26126;&#65288;&#24403;Web Service&#26159;&#19968;&#20010;&#26080;&#29366;&#24577;&#20250;&#35805;Bean&#30340;&#26102;&#20505;&#65289;&#12290;
    &#22312;&#19978;&#36848;&#20363;&#23376;&#20013;&#65292;<tt class="literal">AuctionServiceRemote</tt> &#25509;&#21475;&#24517;&#39035;&#22768;&#26126; <tt class="literal">login()</tt> &#26041;&#27861;&#65292;&#23454;&#38469;&#19978;&#23601;&#26159;&#27880;&#35299; <tt class="literal">@WebMethod</tt>&#12290;
    </p><p>
    &#23601;&#22914;&#20320;&#21487;&#20197;&#22312;&#19978;&#36848;&#20195;&#30721;&#20013;&#25152;&#35265;&#65292;Web Service&#23454;&#29616;&#19968;&#20010;&#22996;&#25176;&#32473;Seam&#20869;&#24314;&#30340; <tt class="literal">Identity</tt> &#32452;&#20214;&#30340; <tt class="literal">login()</tt> &#26041;&#27861;&#12290;
    &#20026;&#20102;&#19982;&#25105;&#20204;&#30340;&#24314;&#35758;&#31574;&#30053;&#19968;&#33268;&#65292;Web Service&#26159;&#20316;&#20026;&#19968;&#20010;&#31616;&#21333;&#30340;&#22806;&#35266;&#32534;&#20889;&#30340;&#65292;&#23558;&#23454;&#38469;&#30340;&#24037;&#20316;&#22996;&#25176;&#32473;Seam&#32452;&#20214;&#12290;
    &#36825;&#26679;&#26377;&#21161;&#20110;&#26368;&#22909;&#22320;&#22312;Web Services&#21644;&#20854;&#20182;&#23458;&#25143;&#31471;&#20043;&#38388;&#37325;&#29992;&#19994;&#21153;&#36923;&#36753;&#12290;
    </p><p>
    &#35753;&#25105;&#20204;&#30475;&#21478;&#19968;&#20010;&#20363;&#23376;&#12290;&#36825;&#20010;Web Service&#26041;&#27861;&#36890;&#36807;&#22996;&#25176;&#32473; <tt class="literal">AuctionAction.createAuction()</tt> &#26041;&#27861;&#65292;&#24320;&#22987;&#20102;&#19968;&#20010;&#26032;&#23545;&#35805;&#12290;
    </p><pre class="programlisting">   @WebMethod
   public void createAuction(String title, String description, int categoryId)
   {
      AuctionAction action = (AuctionAction) Component.getInstance(AuctionAction.class, true);
      action.createAuction();
      action.setDetails(title, description, categoryId);
   }</pre><p>
    &#19979;&#38754;&#26159;&#26469;&#33258; <tt class="literal">AuctionAction</tt> &#30340;&#20195;&#30721;&#65306;
    </p><pre class="programlisting">   @Begin
   public void createAuction()
   {
      auction = new Auction();
      auction.setAccount(authenticatedAccount);
      auction.setStatus(Auction.STATUS_UNLISTED);        
      durationDays = DEFAULT_AUCTION_DURATION;
   }</pre><p>
    &#20174;&#20013;&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#65292;Web Services&#26159;&#22914;&#20309;&#36890;&#36807;&#20805;&#24403;&#22806;&#35266;&#65292;&#24182;&#23558;&#23454;&#38469;&#30340;&#24037;&#20316;&#22996;&#25176;&#32473;&#19968;&#20010;&#23545;&#35805;&#30340;Seam&#32452;&#20214;&#65292;&#26469;&#21442;&#19982;&#38271;&#36816;&#34892;&#23545;&#35805;&#30340;&#12290;
    </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="cache.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="remoting.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;19.&nbsp;&#32531;&#23384;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;21.&nbsp;Remoting</td></tr></table></div></body></html>