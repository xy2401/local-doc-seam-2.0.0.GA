<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;23.&nbsp;Spring Framework&#38598;&#25104;</title><link rel="stylesheet" href="../shared/css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="Seam - &#35821;&#22659;&#30456;&#20851;&#30340;&#32452;&#20214; [&#28385;&#27743;&#32418;20080327]"><link rel="up" href="index.html" title="Seam - &#35821;&#22659;&#30456;&#20851;&#30340;&#32452;&#20214; [&#28385;&#27743;&#32418;20080327]"><link rel="previous" href="gwt.html" title="Chapter&nbsp;22.&nbsp;Seam&#21644;Google&#30340;Web&#24037;&#20855;&#21253;(GWT)"><link rel="next" href="search.html" title="Chapter&nbsp;24.&nbsp;Hibernate Search"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;23.&nbsp;Spring Framework&#38598;&#25104;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="gwt.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="search.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="spring"></a>Chapter&nbsp;23.&nbsp;Spring Framework&#38598;&#25104;</h2></div></div><div></div></div><p>Spring&#38598;&#25104;&#27169;&#22359;&#21487;&#20197;&#25226;&#22522;&#20110;Spring&#30340;&#39033;&#30446;&#36731;&#26494;&#31227;&#26893;&#21040;Seam&#65292;&#24182;&#19988;&#20801;&#35768;Spring&#24212;&#29992;Seam&#30340;&#19968;&#20123;&#20851;&#38190;&#29305;&#24615;&#65292;&#20363;&#22914;&#23545;&#35805;&#65288;Conversation&#65289;&#21644;Seam&#30340;&#39640;&#32423;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#31649;&#29702;&#12290; </p><p>&#35831;&#27880;&#24847;&#65281;Spring&#38598;&#25104;&#20195;&#30721;&#21253;&#21547;&#22312;jboss-seam-ioc&#24211;&#20013;&#12290;&#22312;&#26412;&#31456;&#28041;&#21450;&#30340;&#25152;&#26377;seam-spring&#38598;&#25104;&#25216;&#26415;&#20013;&#37117;&#38656;&#35201;&#24341;&#29992;&#36825;&#20010;&#20381;&#36182;&#12290;</p><p> Seam&#23545;Spring&#25552;&#20379;&#20102;&#22914;&#19979;&#19968;&#20123;&#25903;&#25345;&#65306; </p><div class="itemizedlist"><ul type="disc"><li><p>&#25226;Seam&#30340;&#32452;&#20214;&#23454;&#20363;&#27880;&#20837;&#21040;Spring Bean&#20013;</p></li><li><p>&#25226;Spring Bean&#27880;&#20837;&#21040;Seam&#32452;&#20214;&#20013;</p></li><li><p>&#25226;Spring Bean&#36716;&#25442;&#25104;Seam&#32452;&#20214;</p></li><li><p>&#20801;&#35768;Spring Bean&#23384;&#22312;&#20110;&#20219;&#20309;Seam&#30340;&#19978;&#19979;&#25991;&#20013;</p></li><li><p>&#20351;&#29992;Seam&#32452;&#20214;&#26469;&#21551;&#21160;&#19968;&#20010;Spring WebApplicationContext</p></li><li><p>&#25903;&#25345;Spring PlatformTransactionManagement</p></li><li><p>&#20026;Spring&#30340; <tt class="literal">OpenEntityManagerInViewFilter</tt> &#21644; <tt class="literal">OpenSessionInViewFilter</tt> &#25552;&#20379;&#19968;&#20010;Seam&#31649;&#29702;&#30340;&#26367;&#20195;&#21697;</p></li><li><p>&#25903;&#25345;&#30001; <tt class="literal">@Asynchronous</tt> &#35843;&#29992;&#30340;Spring <tt class="literal">TaskExecutors</tt></p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13331"></a>23.1.&nbsp;&#25226;Seam&#32452;&#20214;&#27880;&#20837;Spring Bean&#20013; </h2></div></div><div></div></div><p>&#35201;&#25226;Seam&#32452;&#20214;&#27880;&#20837;&#21040;Spring Bean&#20013;&#65292;&#38656;&#35201;&#20351;&#29992;&#21040; <tt class="literal">&lt;seam:instance/&gt;</tt> &#21629;&#21517;&#31354;&#38388;&#22788;&#29702;&#22120;&#12290;
		&#35201;&#21551;&#29992;&#35813;&#22788;&#29702;&#22120;&#65292;Spring Bean&#30340;&#23450;&#20041;&#25991;&#20214;&#20013;&#24517;&#39035;&#28155;&#21152;Seam&#21629;&#21517;&#31354;&#38388;&#65306;
         </p><pre class="programlisting">&lt;beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:seam="http://jboss.com/products/seam/spring-seam"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
                        http://jboss.com/products/seam/spring-seam
                        http://jboss.com/products/seam/spring-seam-2.0.xsd"&gt;</pre><p>&#29616;&#22312;&#65292;&#27599;&#19968;&#20010;Seam&#32452;&#20214;&#37117;&#21487;&#20197;&#34987;&#27880;&#20837;&#21040;&#20219;&#24847;Spring Bean&#20013;&#20102;&#65306;</p><pre class="programlisting">&lt;bean id="someSpringBean" class="SomeSpringBeanClass" scope="prototype"&gt;
    &lt;property name="someProperty"&gt;
        &lt;seam:instance name="someComponent"/&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre><p>&#21487;&#20197;&#29992;EL&#34920;&#36798;&#24335;&#26469;&#20195;&#26367;&#32452;&#20214;&#21517;&#65306;</p><pre class="programlisting">&lt;bean id="someSpringBean" class="SomeSpringBeanClass" scope="prototype"&gt;
    &lt;property name="someProperty"&gt;
        &lt;seam:instance name="#{someExpression}"/&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre><p>Seam&#32452;&#20214;&#23454;&#20363;&#29978;&#33267;&#36824;&#21487;&#20197;&#36890;&#36807;Spring Bean id&#26469;&#27880;&#20837;&#21040;Spring Bean&#20013;&#12290; </p><pre class="programlisting">&lt;seam:instance name="someComponent" id="someSeamComponentInstance"/&gt;

&lt;bean id="someSpringBean" class="SomeSpringBeanClass" scope="prototype"&gt;
    &lt;property name="someProperty" ref="someSeamComponentInstance"&gt;
&lt;/bean&gt;
</pre><p>&#35686;&#21578;&#65281;</p><p>Seam&#20351;&#29992;&#22810;&#20010;&#19978;&#19979;&#25991;&#26469;&#23436;&#20840;&#25903;&#25345;&#26377;&#29366;&#24577;&#32452;&#20214;&#12290;Spring&#19981;&#26159;&#36825;&#26679;&#12290;&#21644;Seam&#30340;&#21452;&#21521;&#27880;&#20837;&#65288;bijection&#65289;&#19981;&#21516;&#65292;Spring&#30340;&#27880;&#20837;&#24182;&#19981;&#26159;&#22312;&#26041;&#27861;&#35843;&#29992;&#26102;&#65292;&#32780;&#26159;&#21457;&#29983;&#22312;Spring Bean&#21021;&#22987;&#21270;&#26102;&#12290;&#22240;&#27492;&#65292;Bean&#21021;&#22987;&#21270;&#26102;&#34987;&#29992;&#21040;&#30340;&#37027;&#20010;&#23454;&#20363;&#65292;&#20250;&#22312;Bean&#30340;&#25972;&#20010;&#29983;&#21629;&#21608;&#26399;&#20013;&#19968;&#30452;&#34987;&#20351;&#29992;&#12290;&#20363;&#22914;&#65292;&#19968;&#20010;Seam&#30340; <tt class="literal">CONVERSATION</tt> &#22495;&#32452;&#20214;&#34987;&#30452;&#25509;&#27880;&#20837;&#21040;&#19968;&#20010;&#21333;&#20363;Spring Bean&#20013;&#65292;&#36825;&#20010;&#21333;&#20363;&#30340;Bean&#23558;&#38271;&#26399;&#25345;&#26377;&#36825;&#20010;&#23454;&#20363;&#30340;&#24341;&#29992;&#65292;&#30452;&#21040;&#23545;&#35805;&#32467;&#26463;&#65281;&#25105;&#20204;&#25226;&#36825;&#31181;&#38382;&#39064;&#31216;&#20026; <span class="emphasis"><em>&#22495;&#38459;&#25239;&#65288;scope impedance&#65289;</em></span>&#12290;Seam&#30340;&#21452;&#21521;&#27880;&#20837;&#21487;&#20197;&#24456;&#33258;&#28982;&#22320;&#31649;&#29702;&#22495;&#38459;&#25239;&#65292;&#23601;&#22909;&#35937;&#31995;&#32479;&#20013;&#30340;&#35843;&#29992;&#19968;&#26679;&#12290;&#22312;Spring&#20013;&#65292;&#25105;&#20204;&#38656;&#35201;&#27880;&#20837;&#19968;&#20010;Seam&#32452;&#20214;&#30340;&#20195;&#29702;&#65292;&#24182;&#19988;&#22312;&#20195;&#29702;&#34987;&#35843;&#29992;&#30340;&#26102;&#20505;&#35299;&#26512;&#35813;&#24341;&#29992;&#12290;</p><p><tt class="literal">&lt;seam:instance/&gt;</tt> &#26631;&#31614;&#21487;&#20197;&#33258;&#21160;&#20195;&#29702;Seam&#32452;&#20214;&#12290;</p><pre class="programlisting">&lt;seam:instance id="seamManagedEM" name="someManagedEMComponent" proxy="true"/&gt;

&lt;bean id="someSpringBean" class="SomeSpringBeanClass"&gt;
    &lt;property name="entityManager" ref="seamManagedEM"&gt;
&lt;/bean&gt;</pre><p>&#36825;&#20010;&#20363;&#23376;&#28436;&#31034;&#20102;&#19968;&#31181;&#22312;Spring Bean&#20013;&#20351;&#29992;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#30340;&#26041;&#27861;&#12290;&#65288;&#24819;&#35201;&#20102;&#35299;&#22914;&#20309;&#26356;&#20581;&#22766;&#22320;&#20351;&#29992;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#26469;&#26367;&#25442;Spring&#30340; <tt class="literal">OpenEntityManagerInView</tt> &#36807;&#28388;&#22120;&#65292;&#35831;&#35265; <a href="spring.html#spring-persistence" title="23.6.&nbsp;&#22312;Spring&#20013;&#20351;&#29992;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;"> &#22312;Spring&#20013;&#20351;&#29992;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;</a>&#65289;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13377"></a>23.2.&nbsp;&#23558;Spring Bean&#27880;&#20837;&#21040;Seam&#32452;&#20214;&#20013;</h2></div></div><div></div></div><p>&#23558;Spring Bean&#27880;&#20837;&#21040;Seam&#32452;&#20214;&#23454;&#20363;&#20013;&#26356;&#23481;&#26131;&#65292;&#26377;&#20108;&#31181;&#26041;&#27861;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>&#20351;&#29992;EL&#34920;&#36798;&#24335;&#27880;&#20837;Spring Bean </p></li><li><p>&#25226;Spring Bean&#36716;&#21270;&#20026;Seam&#32452;&#20214; </p></li></ul></div><p>&#25105;&#20204;&#23558;&#22312;&#19979;&#19968;&#23567;&#33410;&#20013;&#35752;&#35770;&#31532;&#20108;&#31181;&#26041;&#27861;&#12290;&#35775;&#38382;Spring Bean&#26368;&#31616;&#21333;&#30340;&#26041;&#27861;&#26159;&#36890;&#36807;EL&#34920;&#36798;&#24335;&#12290;</p><p>Spring&#30340;<tt class="literal">DelegatingVariableResolver</tt>&#26159;Spring&#29992;&#20110;&#25972;&#21512;JSF&#30340;&#19968;&#20010;&#38598;&#25104;&#28857;&#12290;<tt class="literal">VariableResolver</tt> &#20801;&#35768;&#25152;&#26377;&#30340;Spring Bean&#36890;&#36807;Bean id&#22312;EL&#20013;&#34987;&#20351;&#29992;&#12290;&#20320;&#38656;&#35201;&#22312; <tt class="literal">faces-config.xml</tt> &#20013;&#28155;&#21152; <tt class="literal">DelegatingVariableResolver</tt>&#65306;</p><pre class="programlisting">&lt;application&gt;
    &lt;variable-resolver&gt;
        org.springframework.web.jsf.DelegatingVariableResolver
    &lt;/variable-resolver&gt;
&lt;/application&gt;</pre><p>&#25509;&#19979;&#26469;&#20320;&#21487;&#20197;&#20351;&#29992; <tt class="literal">@In</tt> &#26469;&#27880;&#20837; Spring Bean&#65306;</p><pre class="programlisting">@In("#{bookingService}")
private BookingService bookingService;</pre><p>Spring Bean&#22312;EL&#20013;&#30340;&#24212;&#29992;&#19981;&#21333;&#21333;&#21482;&#26377;&#27880;&#20837;&#12290;Seam&#30340;&#20219;&#20309;EL&#34920;&#36798;&#24335;&#20013;&#37117;&#21487;&#20197;&#20351;&#29992;Spring Bean&#65306;&#36807;&#31243;&#21644;&#39029;&#38754;&#27969;&#30340;&#23450;&#20041;&#65292;&#24037;&#20316;&#20869;&#23384;&#26029;&#35328;&#65288;working memory assertions&#65289;&#31561;&#31561;...</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13416"></a>23.3.&nbsp;&#23558;Spring Bean&#36716;&#25442;&#20026;Seam&#32452;&#20214;</h2></div></div><div></div></div><p><tt class="literal">&lt;seam:component/&gt;</tt> &#21629;&#21517;&#31354;&#38388;&#22788;&#29702;&#22120;&#29992;&#20110;&#23558;Spring Bean&#36716;&#25442;&#25104;&#19968;&#20010;Seam&#32452;&#20214;&#12290;&#21482;&#38656;&#35201;&#22312;&#20320;&#24076;&#26395;&#36716;&#25442;&#20026;Seam&#32452;&#20214;&#30340;Bean&#30340;&#22768;&#26126;&#20013;&#21152;&#19978; <tt class="literal">&lt;seam:component/&gt;</tt> &#26631;&#31614;&#21363;&#21487;&#65306;</p><pre class="programlisting">&lt;bean id="someSpringBean" class="SomeSpringBeanClass" scope="prototype"&gt;
    &lt;seam:component/&gt;
&lt;/bean&gt;</pre><p>&#40664;&#35748;&#24773;&#20917;&#19979;, <tt class="literal">&lt;seam:component/&gt;</tt> &#23558;&#20351;&#29992;Bean&#23450;&#20041;&#20013;&#25552;&#20379;&#30340;&#31867;&#21644;&#21517;&#31216;&#26469;&#21019;&#24314;&#19968;&#20010; <tt class="literal">&#26080;&#29366;&#24577;&#65288;STATELESS&#65289;</tt> &#30340;Seam&#32452;&#20214;&#12290;&#26377;&#26102;&#20505;&#65292;&#22312;&#20351;&#29992; <tt class="literal">FactoryBean</tt> &#26102;&#65292;Spring Bean&#30340;&#31867;&#21487;&#33021;&#19981;&#26159;Bean&#23450;&#20041;&#20013;&#30340;&#37027;&#20010;&#31867;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;<tt class="literal">class</tt> &#24212;&#35813;&#26159;&#34987;&#26126;&#30830;&#25351;&#23450;&#30340;&#12290;&#22312;&#21487;&#33021;&#23384;&#22312;&#21629;&#21517;&#20914;&#31361;&#26102;&#38656;&#35201;&#26126;&#30830;&#32473;&#20986;Seam&#30340;&#32452;&#20214;&#21517;&#12290;</p><p>&#22914;&#26524;&#20320;&#24076;&#26395;Spring Bean&#22312;&#19968;&#20010;&#29305;&#23450;&#30340;Seam&#22495;&#20013;&#21463;&#31649;&#29702;&#65292;&#23601;&#20351;&#29992; <tt class="literal">&lt;seam:component/&gt;</tt> &#30340; <tt class="literal">scope</tt> &#23646;&#24615;&#12290;&#22914;&#26524;&#25351;&#23450;&#20102;&#20219;&#20309;&#38750; <tt class="literal">&#26080;&#29366;&#24577;</tt> &#30340;Seam&#22495;&#65292;Spring Bean&#23601;&#24517;&#39035;&#38480;&#23450;&#20026; <tt class="literal">prototype</tt> &#30340;&#12290;&#20808;&#21069;&#23384;&#22312;&#30340;Spring Bean&#36890;&#24120;&#37117;&#26377;&#22522;&#30784;&#30340;&#26080;&#29366;&#24577;&#30340;&#29305;&#24449;&#65292;&#25152;&#20197;&#36890;&#24120;&#24182;&#19981;&#38656;&#35201;&#36825;&#20010;&#23646;&#24615;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13456"></a>23.4.&nbsp;Seam&#20316;&#29992;&#22495;&#30340;Spring Bean</h2></div></div><div></div></div><p>Seam&#38598;&#25104;&#21253;&#20013;&#21516;&#26679;&#20801;&#35768;&#20320;&#20687;Spring 2.0&#39118;&#26684;&#30340;&#33258;&#23450;&#20041;&#20316;&#29992;&#22495;&#37027;&#26679;&#26469;&#20351;&#29992;Seam&#30340;&#19978;&#19979;&#25991;&#12290;&#20320;&#21487;&#20197;&#22312;&#20219;&#24847;Seam&#19978;&#19979;&#25991;&#20013;&#23450;&#20041;Spring Bean&#12290;&#20294;&#26159;&#65292;&#38656;&#35201;&#37325;&#30003;&#30340;&#26159;&#65292;Spring&#30340;&#32452;&#20214;&#27169;&#22411;&#24182;&#38750;&#35774;&#35745;&#20026;&#25903;&#25345;&#29366;&#24577;&#65288;Statefullness&#65289;&#30340;&#65292;&#25152;&#20197;&#35831;&#23567;&#24515;&#20351;&#29992;&#36825;&#19968;&#29305;&#24615;&#12290;&#29305;&#21035;&#26159;Session&#21644;Conversation&#20316;&#29992;&#22495;&#30340;Spring Bean&#38598;&#32676;&#24456;&#26377;&#38382;&#39064;&#65292;&#20174;&#22823;&#20316;&#29992;&#22495;&#27880;&#20837;&#21040;&#23567;&#20316;&#29992;&#22495;&#26102;&#20063;&#35201;&#26684;&#22806;&#23567;&#24515;&#12290;</p><p>&#19968;&#26086;&#22312;Spring&#30340;Bean Factory&#37197;&#32622;&#20013;&#25351;&#23450;&#20102; <tt class="literal">&lt;seam:configure-scopes/&gt;</tt>&#65292;&#25152;&#26377;&#30340;Seam&#20316;&#29992;&#22495;&#37117;&#23558;&#20197;&#33258;&#23450;&#20041;&#20316;&#29992;&#22495;&#30340;&#24418;&#24335;&#26292;&#38706;&#32473;Spring Bean&#12290;&#35201;&#23558;&#19968;&#20010;Spring Bean&#19982;&#26576;&#20010;&#29305;&#23450;&#30340;Seam&#20316;&#29992;&#22495;&#32852;&#31995;&#36215;&#26469;&#26102;&#65292;&#35831;&#22312;bean&#23450;&#20041;&#30340; <tt class="literal">scope</tt> &#23646;&#24615;&#20013;&#25351;&#23450;Seam&#20316;&#29992;&#22495;&#12290;</p><pre class="programlisting">&lt;!-- Only needs to be specified once per bean factory--&gt;
&lt;seam:configure-scopes/&gt;

...

&lt;bean id="someSpringBean" class="SomeSpringBeanClass" scope="seam.CONVERSATION"/&gt;</pre><p>&#20316;&#29992;&#22495;&#21517;&#30340;&#21069;&#32512;&#21487;&#20197;&#36890;&#36807; <tt class="literal">configure-scopes</tt> &#23450;&#20041;&#30340; <tt class="literal">prefix</tt> &#23646;&#24615;&#26469;&#20462;&#25913;&#12290;&#65288;&#40664;&#35748;&#30340;&#21069;&#32512;&#26159;<tt class="literal">seam</tt>&#12290;&#65289;</p><p>&#20197;&#36825;&#31181;&#26041;&#24335;&#23450;&#20041;&#30340;Seam&#20316;&#29992;&#22495;Spring Bean&#21487;&#34987;&#27880;&#20837;&#21040;&#20854;&#23427;Spring Bean&#32780;&#26080;&#38656;&#20351;&#29992; <tt class="literal">&lt;seam:instance/&gt;</tt>&#12290;&#20294;&#26159;&#65292;&#20173;&#35201;&#23567;&#24515;&#30830;&#35748;&#22495;&#38459;&#25239;&#26159;&#21542;&#24471;&#21040;&#32500;&#25252;&#12290;&#36890;&#24120;&#65292;&#22312;Spring&#20013;&#30340;&#19968;&#33324;&#20570;&#27861;&#26159;&#22312;Bean&#23450;&#20041;&#20013;&#25351;&#23450; <tt class="literal">&lt;aop:scoped-proxy/&gt;</tt>&#12290;&#20294;&#26159;&#65292;Seam&#20316;&#29992;&#22495;&#30340;Spring Bean&#24182; <span class="emphasis"><em>&#19981;</em></span> &#20860;&#23481;&#20110; <tt class="literal">&lt;aop:scoped-proxy/&gt;</tt>&#12290;&#25152;&#20197;&#22914;&#26524;&#20320;&#38656;&#35201;&#21521;&#26576;&#20010;&#21333;&#20363;&#20013;&#27880;&#20837;Seam&#20316;&#29992;&#22495;&#30340;Spring Bean&#65292;&#24517;&#39035;&#20351;&#29992; <tt class="literal">&lt;seam:instance/&gt;</tt>&#65306;</p><pre class="programlisting">&lt;bean id="someSpringBean" class="SomeSpringBeanClass" scope="seam.CONVERSATION"/&gt;

...

&lt;bean id="someSingleton"&gt;
    &lt;property name="someSeamScopedSpringBean"&gt;
        &lt;seam:instance name="someSpringBean" proxy="true"/&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-transactions"></a>23.5.&nbsp;&#20351;&#29992;Spring PlatformTransactionManagement</h2></div></div><div></div></div><p>Spring&#25552;&#20379;&#20102;&#25903;&#25345;&#22810;&#31181;&#20107;&#21153;API&#65288;JPA&#12289;Hibernate&#12289;JDO&#21644;JTA&#65289;&#30340;&#21487;&#25193;&#23637;&#20107;&#21153;&#31649;&#29702;&#25277;&#35937;&#65292;&#36824;&#25552;&#20379;&#20102;&#19982;&#35832;&#22914;WebSphere&#21644;WebLogic&#20043;&#31867;&#30340;&#24212;&#29992;&#26381;&#21153;&#22120;TransactionManagers&#30340;&#32039;&#23494;&#38598;&#25104;&#12290;Spring&#20107;&#21153;&#31649;&#29702;&#25903;&#25345;&#24456;&#22810;&#39640;&#32423;&#29305;&#24615;&#65292;&#20363;&#22914;&#20869;&#23884;&#20107;&#21153;&#21644;&#23436;&#25972;&#30340;Java EE&#20107;&#21153;&#20256;&#25773;&#35268;&#21017;&#65288;REQUIRES_NEW&#12289;NOT_SUPPORTED&#31561;&#31561;&#65289;&#12290;&#24819;&#35201;&#33719;&#24471;&#26356;&#22810;&#20449;&#24687;&#65292;&#35831;&#35265;<a href="http://static.springframework.org/spring/docs/2.0.x/reference/transaction.html" target="_top">Spring&#25991;&#26723;</a>&#12290;</p><p>&#22914;&#19979;&#37197;&#32622;Seam&#23558;&#21551;&#29992;SpringTransaction&#32452;&#20214;&#26469;&#20351;&#29992;Spring&#20107;&#21153;&#65306;</p><pre class="programlisting">&lt;spring:spring-transaction platform-transaction-manager="#{transactionManager}"/&gt;</pre><p>
			<tt class="literal">spring:spring-transaction</tt>&#32452;&#20214;&#23558;&#21033;&#29992;Spring&#20107;&#21153;&#21516;&#27493;&#33021;&#21147;&#26469;&#21516;&#27493;&#22238;&#35843;&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-persistence"></a>23.6.&nbsp;&#22312;Spring&#20013;&#20351;&#29992;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;</h2></div></div><div></div></div><p>Seam&#30340;&#26368;&#24378;&#22823;&#30340;&#21151;&#33021;&#20043;&#19968;&#26159;&#23427;&#30340;&#23545;&#35805;&#20316;&#29992;&#22495;&#65288;conversation scope&#65289;&#21644;&#20026;&#23545;&#35805;&#21608;&#26399;&#25552;&#20379;&#19968;&#20010;EntityManager&#30340;&#33021;&#21147;&#12290;&#36825;&#28040;&#38500;&#20102;&#24456;&#22810;&#19982;&#23454;&#20307;&#30340;&#20998;&#31163;&#21644;&#37325;&#32452;&#30456;&#20851;&#30340;&#38382;&#39064;&#65292;&#20943;&#23569;&#20102; <tt class="literal">LazyInitializationException</tt> &#30340;&#21457;&#29983;&#12290;Spring&#27809;&#26377;&#31649;&#29702;&#36229;&#20986;&#21333;&#20010;Web&#35831;&#27714;&#20316;&#29992;&#22495;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#30340;&#26041;&#27861;&#65288;<tt class="literal">OpenEntityManagerInViewFilter</tt>&#65289;&#12290;&#25152;&#20197;&#65292;&#22914;&#26524;Spring&#24320;&#21457;&#32773;&#33021;&#22815;&#29992;&#19982;Spring&#38598;&#25104;JPA&#25152;&#29992;&#30340;&#30456;&#21516;&#24037;&#20855;&#26469;&#35775;&#38382;&#19968;&#20010;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#30340;&#35805;&#23601;&#20877;&#22909;&#19981;&#36807;&#20102;&#12290;&#65288;&#20363;&#22914;<tt class="literal">PersistenceAnnotationBeanPostProcessor</tt>&#12289;<tt class="literal">JpaTemplate</tt>&#31561;&#31561;&#12290;&#65289;</p><p>Seam&#21487;&#20197;&#35753;Spring&#21033;&#29992;&#23427;&#30340;JPA&#24037;&#20855;&#35775;&#38382;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#65292;&#36825;&#35753;Spring&#24212;&#29992;&#25317;&#26377;&#20102;&#23545;&#35805;&#20316;&#29992;&#22495;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#30340;&#33021;&#21147;&#12290;</p><p>&#35813;&#38598;&#25104;&#25552;&#20379;&#20197;&#19979;&#21151;&#33021;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>&#20351;&#29992;Spring&#25552;&#20379;&#30340;&#24037;&#20855;&#36879;&#26126;&#22320;&#35775;&#38382;&#19968;&#20010;Seam&#31649;&#29702;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;</p></li><li><p>&#22312;&#38750;Web&#35831;&#27714;&#20013;&#35775;&#38382;Seam&#20250;&#35805;&#20316;&#29992;&#22495;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#65288;&#20363;&#22914;&#24322;&#27493;Quartz&#20219;&#21153;&#20013;&#65289;</p></li><li><p>&#32771;&#34385;&#20351;&#29992;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#21644;Spring&#31649;&#29702;&#30340;&#20107;&#21153;&#65288;&#23558;&#38656;&#35201;&#25163;&#21160;&#28165;&#38500;&#32531;&#20914;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#65289;</p></li></ul></div><p>Spring&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#20256;&#25773;&#27169;&#22411;&#20801;&#35768;&#27599;&#20010;EntityManagerFactory&#20165;&#26377;&#19968;&#20010;&#25171;&#24320;&#30340;EntityManager&#65292;&#25152;&#20197;Seam&#38598;&#25104;&#23601;&#23553;&#35013;&#19968;&#20010;EntityManagerFactory&#65292;&#20854;&#20013;&#25918;&#20837;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#12290;</p><pre class="programlisting">&lt;bean id="seamEntityManagerFactory" class="org.jboss.seam.ioc.spring.SeamManagedEntityManagerFactoryBean"&gt;
   	&lt;property name="persistenceContextName" value="entityManager"/&gt;
&lt;/bean&gt;</pre><p>'persistenceContextName'&#26159;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#32452;&#20214;&#30340;&#21517;&#23383;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#35813;EntityManagerFactory&#26377;&#19968;&#20010;&#21644;Seam&#32452;&#20214;&#21517;&#19968;&#26679;&#30340;unitName&#65292;&#25110;&#32773;&#20687;&#20363;&#23376;&#20013;&#37027;&#26679;&#21517;&#20026;'entityManager'&#12290;&#22914;&#26524;&#20320;&#24076;&#26395;&#25552;&#20379;&#19968;&#20010;&#19981;&#21516;&#30340;unitName&#65292;&#20320;&#33021;&#22815;&#36890;&#36807;&#25552;&#20379;&#19968;&#20010;persistenceUnitName&#26469;&#23454;&#29616;&#65292;&#22914;&#19979;&#25152;&#31034;&#65306;</p><pre class="programlisting">&lt;bean id="seamEntityManagerFactory" class="org.jboss.seam.ioc.spring.SeamManagedEntityManagerFactoryBean"&gt;
   	&lt;property name="persistenceContextName" value="entityManager"/&gt;
	&lt;property name="persistenceUnitName" value="bookingDatabase:extended"/&gt;
&lt;/bean&gt;</pre><p>&#36825;&#20010;EntityManagerFactory&#33021;&#22312;&#20219;&#20309;Spring&#25552;&#20379;&#30340;&#24037;&#20855;&#20013;&#34987;&#20351;&#29992;&#12290;&#20363;&#22914;&#65292;&#21487;&#20197;&#20687;&#20197;&#21069;&#37027;&#26679;&#20351;&#29992;Spring&#30340; <tt class="literal">PersistenceAnnotationBeanPostProcessor</tt>&#12290;</p><pre class="programlisting">&lt;bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor"/&gt;</pre><p>&#22914;&#26524;&#20320;&#22312;Spring&#20013;&#23450;&#20041;&#20320;&#30495;&#27491;&#30340;EntityManagerFactory&#20294;&#24076;&#26395;&#20351;&#29992;&#19968;&#20010;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#65292;&#20320;&#33021;&#22815;&#21578;&#35785; <tt class="literal">PersistenceAnnotationBeanPostProcessor</tt> &#20320;&#40664;&#35748;&#24076;&#26395;&#20351;&#29992;&#21738;&#20010;persistenctUnitName&#65292;&#21487;&#20197;&#36890;&#36807;&#25351;&#23450; <tt class="literal">defaultPersistenceUnitName</tt> &#26469;&#23454;&#29616;&#12290;</p><p><tt class="literal">applicationContext.xml</tt> &#25991;&#20214;&#21487;&#33021;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p><pre class="programlisting">&lt;bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalEntityManagerFactoryBean"&gt;
	&lt;property name="persistenceUnitName" value="bookingDatabase"/&gt;
&lt;/bean&gt;
&lt;bean id="seamEntityManagerFactory" class="org.jboss.seam.ioc.spring.SeamManagedEntityManagerFactoryBean"&gt;
   	&lt;property name="persistenceContextName" value="entityManager"/&gt;
	&lt;property name="persistenceUnitName" value="bookingDatabase:extended"/&gt;
&lt;/bean&gt;
&lt;bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor"&gt;
	&lt;property name="defaultPersistenceUnitName" value="bookingDatabase:extended"/&gt;
&lt;/bean&gt;</pre><p><tt class="literal">component.xml</tt> &#25991;&#20214;&#21487;&#33021;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p><pre class="programlisting">&lt;persistence:managed-persistence-context name="entityManager"
	auto-create="true" entity-manager-factory="#{entityManagerFactory}"/&gt;</pre><p><tt class="literal">JpaTemplate</tt> &#21644; <tt class="literal">JpaDaoSupport</tt> &#30340;&#37197;&#32622;&#26041;&#27861;&#19981;&#21464;&#12290;</p><pre class="programlisting">&lt;bean id="bookingService" class="org.jboss.seam.example.spring.BookingService"&gt;
	&lt;property name="entityManagerFactory" ref="seamEntityManagerFactory"/&gt;
&lt;/bean&gt;</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-hibernate"></a>23.7.&nbsp;&#22312;Spring&#20013;&#20351;&#29992;Seam&#31649;&#29702;&#30340;Hibernate&#20250;&#35805;</h2></div></div><div></div></div><p>Seam&#30340;Spring&#38598;&#25104;&#25903;&#25345;&#20351;&#29992;Spring&#30340;&#24037;&#20855;&#26469;&#23436;&#25972;&#35775;&#38382;Seam&#31649;&#29702;&#30340;Hibernate&#20250;&#35805;&#65288;Hibernate Session&#65289;&#12290;&#36825;&#21644; <a href="spring.html#spring-persistence" title="23.6.&nbsp;&#22312;Spring&#20013;&#20351;&#29992;Seam&#31649;&#29702;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;">JPA&#38598;&#25104;</a> &#24456;&#20687;&#12290;</p><p>&#19982;Spring&#30340;JPA&#38598;&#25104;&#19968;&#26679;&#65292;&#22312;Spring&#30340;&#24037;&#20855;&#20013;&#65292;Spring&#30340;&#20256;&#25773;&#27169;&#22411;&#21482;&#20801;&#35768;&#27599;&#20010;EntityManagerFactory&#22312;&#19968;&#20010;&#20107;&#21153;&#37324;&#25317;&#26377;&#19968;&#20010;&#25171;&#24320;&#30340;EntityManager&#12290;&#25152;&#20197;Seam Session&#38598;&#25104;&#23553;&#35013;&#20102;&#19968;&#20010;&#20195;&#29702;SessionFactory&#65292;&#20854;&#20013;&#21253;&#21547;&#19968;&#20010;Seam&#31649;&#29702;&#30340;Hibernate&#20250;&#35805;&#19978;&#19979;&#25991;&#12290;</p><pre class="programlisting">&lt;bean id="seamSessionFactory" class="org.jboss.seam.ioc.spring.SeamManagedSessionFactoryBean"&gt;
	&lt;property name="sessionName" value="hibernateSession"/&gt;
&lt;/bean&gt;</pre><p>'sessionName'&#26159;<tt class="literal">persistence:managed-hibernate-session</tt> &#32452;&#20214;&#30340;&#21517;&#23383;&#12290;&#35813;SessionFactory&#21487;&#34987;&#29992;&#20110;&#20219;&#24847;Spring&#25552;&#20379;&#30340;&#24037;&#20855;&#20013;&#12290;&#35813;&#38598;&#25104;&#25903;&#25345;&#23545; <tt class="literal">SessionFactory.getCurrentInstance()</tt> &#30340;&#35843;&#29992;&#65292;&#21482;&#35201;&#35843;&#29992; <tt class="literal">SeamManagedSessionFactory</tt> &#30340; getCurrentInstance() &#26041;&#27861;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13616"></a>23.8.&nbsp;&#20316;&#20026;Seam&#32452;&#20214;&#30340;Spring&#24212;&#29992;&#19978;&#19979;&#25991;</h2></div></div><div></div></div><p>&#23613;&#31649;&#20320;&#21487;&#20197;&#20351;&#29992;Spring&#30340;<tt class="literal">ContextLoaderListener</tt> &#26469;&#21551;&#21160;&#24212;&#29992;&#31243;&#24207;&#30340;Spring ApplicationContext&#65292;&#20294;&#36825;&#31181;&#20570;&#27861;&#23384;&#22312;&#19968;&#20123;&#23616;&#38480;&#12290;</p><div class="itemizedlist"><ul type="disc"><li><p>Spring&#30340;ApplicationContext&#24517;&#39035;&#24320;&#22987;&#20110; <tt class="literal">SeamListener</tt><span class="emphasis"><em> &#20043;&#21518;</em></span>
				</p></li><li><p>&#35201;&#20026;Seam&#30340;&#21333;&#20803;&#21644;&#38598;&#25104;&#27979;&#35797;&#21551;&#21160;&#19968;&#20010;Spring ApplicationContext&#26377;&#20123;&#40635;&#28902;</p></li></ul></div><p>&#20026;&#31361;&#30772;&#36825;&#20108;&#20010;&#23616;&#38480;&#65292;Spring&#38598;&#25104;&#21253;&#25324;&#19968;&#20010;&#21551;&#21160;Spring ApplicationContext&#30340;Seam&#32452;&#20214;&#12290;&#22312; <tt class="literal">components.xml</tt> &#20013;&#28155;&#21152; <tt class="literal">&lt;spring:context-loader/&gt;</tt> &#23450;&#20041;&#23601;&#33021;&#20351;&#29992;&#35813;&#32452;&#20214;&#12290;&#22312; <tt class="literal">config-locations</tt> &#23646;&#24615;&#20013;&#25351;&#23450;Spring&#19978;&#19979;&#25991;&#25991;&#20214;&#20301;&#32622;&#12290;&#22914;&#26524;&#38656;&#35201;&#37197;&#32622;&#22810;&#20010;&#37197;&#32622;&#25991;&#20214;&#65292;&#20320;&#21487;&#20197;&#25353;&#29031;&#26631;&#20934; <tt class="literal">components.xml</tt> &#30340;&#22810;&#20540;&#37197;&#32622;&#23454;&#36341;&#65292;&#25226;&#23427;&#20204;&#32622;&#20110;&#20869;&#23884;&#30340; <tt class="literal">&lt;spring:config-locations/&gt;</tt> &#20803;&#32032;&#20013;&#12290;</p><pre class="programlisting">&lt;components xmlns="http://jboss.com/products/seam/components"
            xmlns:spring="http://jboss.com/products/seam/spring"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://jboss.com/products/seam/components
                                http://jboss.com/products/seam/components-2.0.xsd
                                http://jboss.com/products/seam/spring
                                http://jboss.com/products/seam/spring-2.0.xsd"&gt;

	&lt;spring:context-loader context-locations="/WEB-INF/applicationContext.xml"/&gt;

&lt;/components&gt;</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13655"></a>23.9.&nbsp;&#20351;&#29992;Spring TaskExecutor&#30340;@Asynchronous</h2></div></div><div></div></div><p>Spring&#25552;&#20379;&#20102;&#21517;&#20026; <tt class="literal">TaskExecutor</tt> &#30340;&#24322;&#27493;&#20195;&#30721;&#25191;&#34892;&#25277;&#35937;&#12290;&#22312;&#35843;&#29992;&#26377; <tt class="literal">@Asynchronous</tt> &#30340;&#26041;&#27861;&#26102;&#65292;Spring Seam&#38598;&#25104;&#21487;&#20197;&#20351;&#29992; <tt class="literal">TaskExecutor</tt>&#12290;&#35201;&#21551;&#29992;&#35813;&#21151;&#33021;&#65292;&#38656;&#37197;&#32622; <tt class="literal">SpringTaskExecutorDispatchor</tt> &#24182;&#25552;&#20379;&#19968;&#20010;&#23450;&#20041;&#20102;taskExecutor&#30340;Spring Bean&#65306;</p><pre class="programlisting">&lt;spring:task-executor-dispatcher task-executor="#{springThreadPoolTaskExecutor}"/&gt;</pre><p>&#22240;&#20026;Spring&#30340; <tt class="literal">TaskExecutor</tt> &#24182;&#19981;&#25903;&#25345;&#24322;&#27493;&#20107;&#20214;&#35843;&#24230;&#65292;&#25152;&#20197;&#21487;&#20197;&#25552;&#20379;&#19968;&#20010;&#22238;&#35843;&#30340;Seam <tt class="literal">Dispatcher</tt> &#26469;&#22788;&#29702;&#24322;&#27493;&#20107;&#20214;&#35843;&#24230;&#65306;</p><pre class="programlisting">&lt;!-- Install a ThreadPoolDispatcher to handle scheduled asynchronous event --&gt;
&lt;core:thread-pool-dispatcher name="threadPoolDispatcher"/&gt;

&lt;!-- Install the SpringDispatcher as default --&gt;
&lt;spring:task-executor-dispatcher task-executor="#{springThreadPoolTaskExecutor}" schedule-dispatcher="#{threadPoolDispatcher}"/&gt;</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="gwt.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="search.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;22.&nbsp;Seam&#21644;Google&#30340;Web&#24037;&#20855;&#21253;(GWT)&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;24.&nbsp;Hibernate Search</td></tr></table></div></body></html>